<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>Airbnb.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>Airbnb</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/index-CGfe1Tpd.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/preload-helper-BW0IMuFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/hotkeys-uKX61F1_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/defaultLocale-BLUna9fQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/precisionRound-Cl9k9ZmS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/defaultLocale-DzliDDTm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/vega-loader.browser-C8wT63Va.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/tooltip-CrRUCOBw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/clsx-D0MtrJOx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cn-C1rgT0yh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/react-BGmjiNul.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/compiler-runtime-DeeZ7FnK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/jsx-runtime-DN_bIXfG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/badge-DAnNhy3O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useEventListener-COkmyg1v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/button-DuYGqRtX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/react-dom-C9fstfnp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/Combination-D1TsGrBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/menu-items-9PZrU2e0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CBrDuocE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/createLucideIcon-CW2xpJ57.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/check-CrAQug3q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/select-D0g5GnIs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/tooltip-CvjcEpZC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/use-toast-Bzf3rpev.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseIsEqual-Cz9Tt_-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useEvent-DlWF5OMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/invariant-C6yE60hi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/zod-Cg4WLWh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/utils-CJJIceVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/constants-Bkp4R3bQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/Deferred-DzyBMRsy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/config-babG4OBR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/uuid-ClFZlR7U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/DeferredRequestRegistry-B3BENoUa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/requests-C0HaHO6a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_hasUnicode-zBEpxwYe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useLifecycle-CmDXEyIC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useNonce-EAuSVK-5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useTheme-DfP1CWaW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/once-CTiSlR1m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/capabilities-BmAOeMOK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/createReducer-DDa-hVe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CAcX026F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-DKNOF5xd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CI6_zMIl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-BVf1IY4_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-Cq_4nPfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CVj-_Iiz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-HGZzCB0y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-RKnr9SNh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-BuhT82Xx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/stex-0ac7Aukl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toDate-5JckKRQn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cjs-Bj40p_Np.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_arrayReduce-bZBYsK-u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/type-BdyvjzTI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseProperty-DuoFhI7N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/debounce-BbFlGgjv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/database-zap-CaVvnK_o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/main-CwSdzVhm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cells-D_SkyFDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/ErrorBoundary-Drf1manw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/kbd-Czc5z_04.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useInstallPackage-RldLPyJs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/alert-dialog-k5KxevGr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dialog-DUEuLcT2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDebounce-em3gna-v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/numbers-C9_R_vlY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/SSRProvider-DD7JA3RM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/context-BAYdLMF_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useNumberFormatter-D8ks3oPN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/usePress-C2LPFxyv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/input-CaEtLL8p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/ImperativeModal-q6QlC2aZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cell-link-BoUpLV2S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/multi-map-fjX9ImVF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/alert-BEdExd6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chevron-right-CqEd11Di.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dropdown-menu-BP4_BZLr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/links-DNmjkr65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/datasource-CR_zEq5o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/state-kFdt1US2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/MarimoErrorOutput-Orp0blpZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/copy-DRhpWiOq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/copy-gBVL4NN-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/copy-icon-B69c-352.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/spinner-C1czjtp7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/es-CEEVxHsX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/focus-D18AHojc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/LazyAnyLanguageCodeMirror-jpEDlD0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/katex-AwOI3EvM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/marked.esm-CHnOtnr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chunk-OGVTOU66-CjNLT2C3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/markdown-renderer-C_xfLXiO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-DOFFh6Ii.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/command-Qt3ng7cb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/popover-DtnzNVk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useRunCells-BZ_OFvV4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/mode-BFwdGSZ7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/purify.es-N-2faAGj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/RenderHTML-BzGWfPTJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/table--_20dwBZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/tabs-Ctk4D03n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useAsyncData-BJJJOr9W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useIframeCapabilities-CU-WWxnz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/error-banner-DU5Qb8a8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/formats-B9CrBoaO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/en-US-DhMN8sxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/isValid-DhzaK-Y1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dates-CdsE1R40.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/download-CITws1-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/maps-s2pQkyf5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/extends-B9D0JO9U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/emotion-is-prop-valid.esm-lG8j6oqk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDateFormatter-CV0QXb5P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/range-sshwVRcP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/capitalize-DQeWKRGx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/table-BLx7B_us.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/JsonOutput-BLd1jTNA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/file-BnFXtaZZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/play-BJDBXApx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chat-components-6dWNbFjV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/isEmpty-DIxUV1UR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/circle-check-big-OIMTUpe6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chat-display-Cfg38gMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/ai-model-dropdown-DZ7evAGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/renderShortcut-D0Pei-OA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDeleteCell-GHwc6J4l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/icons-D4lB4En9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/process-output-4w8xDO0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/blob-Dg_vNTSs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/objectWithoutPropertiesLoose-CboCOq4o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/esm-B3JckBtM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/add-cell-with-ai-Dx5UA23s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chart-no-axes-column-D42sFB6d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/square-function-DxXFdbn8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/spec-qp_XZeSS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/column-preview-9nPwQyJZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/switch-C9iBa4rX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toggle-G1t0cQyf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/globals-D3SeIm1j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/share-CXQVxivL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseSet-6FYvpjrm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/react-resizable-panels.browser.esm-BqxQegSf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/utilities.esm-FYD46c3d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/floating-outline-p0aHdM2W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useAddCell-CVfRv5mq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/eye-off-D9zAYqG9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/plus-CHesBJpY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/readonly-python-code-DjP4vjBQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/file-video-camera-CZUg-nFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/types-VzFAm7Cv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/label-qwandMoh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/textarea-D2hGxqGj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/refresh-ccw-DbW1_PHb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/trash-2-C-lF7BNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/form-DEraWoX5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/field-DDKGFzpC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useBoolean-5kuXz69O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDeepCompareMemoize-gzLRYatP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/types-B42u_5hF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/prop-types-C638SUfx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/es-FiXEquL2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/VisuallyHidden-BodIky8L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/hasIn-DydgU7lx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseFlatten-CLPh0yMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/flatten-Buk63LQO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/pick-DeQioq0G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/code-xml-MBUyxNtK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/download-DobaYJPt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/globe-CY9im410.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/refresh-cw-Din9uFKE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/settings-MTlHVxz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/square-leQTJTJJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/triangle-alert-CbD0f2J6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/bundle.esm-B0Sy2M4C.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/index-BQNCH-dG.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "Airbnb.py",
            "mode": "read",
            "version": "0.19.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "full", "reference_highlighting": true, "theme": "system"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"auto_download": ["ipynb", "html"], "sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "from pyspark.sql import SparkSession\nfrom pyspark.sql.types import DateType, DoubleType\nimport pyspark.sql.functions as F", "code_hash": "bbc58d95b6cb37b6e588bb012cd2a62e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "spark = SparkSession.builder.appName(\"Airbnb Listing Overview\") \\\n    .master(\"local[*]\") \\\n    .getOrCreate()", "code_hash": "b243ec0ad17b4113f458c192a2cccd8c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "df = (\n    spark.read.csv(\n        \"./data/listings/\",\n        header=True,\n        inferSchema=True,\n        quote='\"',\n        escape='\"',\n        multiLine=True,\n    )\n    .withColumn(\n        \"filename\",\n        F.split(F.input_file_name(), \"/\").getItem(\n            F.size(F.split(F.input_file_name(), \"/\")) - 1\n        ),\n    )\n    .withColumns(\n        {\n            \"city\": F.split(\"filename\", \"_\").getItem(1),\n            \"price\": F.try_to_number(\"price\", F.lit(\"$999,999,999.99\")).cast(DoubleType()),\n        }\n    ).filter(F.col(\"price\").isNotNull())\n    .select(\"id\", \"price\", \"last_scraped\", \"city\")\n)\n\ndf.show()", "code_hash": "6e503edff7ca66020528008c1e689bcc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "from pyspark.sql.window import Window\n\na = df.withColumn(\"rn\", F.row_number().over(Window.partitionBy(\"id\").orderBy(F.col(\"last_scraped\").desc()))).filter(F.col(\"rn\") == 1).drop(\"rn\")\na.show()", "code_hash": "4cc047c8fffd0c23336b6a7eace00983", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "from pyspark.sql.functions import regexp_replace\n\ndf \\\n    .select(\"city\", \"price\", \"accommodates\") \\\n    .withColumn(\"price\", regexp_replace(col(\"price\"), \"[$|,]\", \"\").cast(\"double\")) \\\n    .withColumn(\"accommodates\", col(\"accommodates\").try_cast(\"integer\")) \\\n    .withColumn(\"average\", col(\"price\") / col(\"accommodates\")) \\\n    .dropna() \\\n    .groupby(\"city\") \\\n    .agg(mean(\"average\")) \\\n    .explain(True)", "code_hash": "6385fb302eb4199e7d55cf9bfe61c5f4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "# from pyspark.sql.functions import percent_rank, expr\n# from pyspark.sql.window import Window\n\n# windowSpec = Window.partitionBy(\"city\").orderBy(\"average\")\n\n# df \\\n#     .select(\"city\", \"price\", \"accommodates\") \\\n#     .withColumn(\"price\", regexp_replace(col(\"price\"), \"[$|,]\", \"\").cast(\"double\")) \\\n#     .withColumn(\"accommodates\", col(\"accommodates\").try_cast(\"integer\")) \\\n#     .withColumn(\"average\", col(\"price\") / col(\"accommodates\")) \\\n#     .dropna() \\\n#     .groupby(\"city\") \\\n#     .agg(\n#         expr(\"percentile_approx(average, 0.25)\").alias(\"p25\"),\n#         expr(\"percentile_approx(average, 0.90)\").alias(\"p90\")\n#     )", "code_hash": "e8425b2e7cdf3c726f7a37558e503ca8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "a.plot.bar(x='PercentRank', y='PercentRank')", "code_hash": "2bd7126d3e0b8ac5f2734b3019843c00", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "df \\\n    .select(\"city\", \"bedrooms\", \"price\") \\\n    .dropna() \\\n    .count()", "code_hash": "e5c25a916d1eb1fedffbf54a1f67d614", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "# spark.stop()", "code_hash": "8f40f19654236b4fcb0f63c4efd5efd2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}], "metadata": {"marimo_version": "0.19.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "bbc58d95b6cb37b6e588bb012cd2a62e", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b243ec0ad17b4113f458c192a2cccd8c", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "WARNING: Using incubator modules: jdk.incubator.vector\nUsing Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n26/01/20 11:44:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n", "type": "stream"}], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6e503edff7ca66020528008c1e689bcc", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "\r                                                                                \r\r[Stage 5:======\u003E                                                    (1 + 8) / 9]\r\r[Stage 5:===================\u003E                                       (3 + 6) / 9]\r\r[Stage 5:=============================================\u003E             (7 + 2) / 9]\r\r[Stage 5:====================================================\u003E      (8 + 1) / 9]\r\r                                                                                \r/Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/.venv/lib/python3.14/site-packages/pyspark/sql/classic/column.py:359: FutureWarning: A column as 'key' in getItem is deprecated as of Spark 3.0, and will not be supported in the future release. Use `column[key]` or `column.key` syntax instead.\n  warnings.warn(\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "+------+-----+------------+------+\n|    id|price|last_scraped|  city|\n+------+-----+------------+------+\n|264776|297.0|  2025-06-11|london|\n|264777| 98.0|  2025-06-11|london|\n|264778|148.0|  2025-06-11|london|\n|264779|144.0|  2025-06-11|london|\n|264780|157.0|  2025-06-11|london|\n|264781|148.0|  2025-06-11|london|\n|264782|120.0|  2025-06-11|london|\n|264783|216.0|  2025-06-11|london|\n|264789|238.0|  2025-06-11|london|\n|266037| 62.0|  2025-06-12|london|\n|268398| 66.0|  2025-06-12|london|\n|270600| 73.0|  2025-06-11|london|\n|426351|134.0|  2025-06-12|london|\n|426354|200.0|  2025-06-12|london|\n|427327|155.0|  2025-06-12|london|\n|427348|135.0|  2025-06-12|london|\n|427584|129.0|  2025-06-12|london|\n|427936| 70.0|  2025-06-12|london|\n|274740|248.0|  2025-06-12|london|\n| 13913| 72.0|  2025-06-12|london|\n+------+-----+------------+------+\nonly showing top 20 rows\n", "type": "stream"}], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "4cc047c8fffd0c23336b6a7eace00983", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "26/01/20 11:46:40 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2025-01-09_toronto_listings.csv.gz\n\r[Stage 10:\u003E                                                       (0 + 11) / 12]\r26/01/20 11:46:41 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2025-01-03_new-york-city_listings.csv.gz\n26/01/20 11:46:43 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2024-12-27_mexico-city_listings.csv.gz\n26/01/20 11:46:43 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2024-12-25_bangkok_listings.csv.gz\n26/01/20 11:46:44 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2025-12-04_new-york-city_listings.csv.gz\n\r[Stage 10:=========\u003E                                              (2 + 10) / 12]\r26/01/20 11:46:44 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2025-12-04_los-angeles_listings.csv.gz\n26/01/20 11:46:44 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2024-12-30_tokyo_listings.csv.gz\n\r[Stage 10:===================\u003E                                     (4 + 8) / 12]\r\r[Stage 10:=================================\u003E                       (7 + 5) / 12]\r\r[Stage 10:==============================================\u003E         (10 + 2) / 12]\r26/01/20 11:46:45 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/nikhils/Documents/workshop/Learning-Spark-Airbnb/data/listings/2025-12-04_san-francisco_listings.csv.gz\n\r[Stage 10:===================================================\u003E    (11 + 1) / 12]\r\r                                                                                \r", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "+-----+-----+------------+-------------+\n|   id|price|last_scraped|         city|\n+-----+-----+------------+-------------+\n| 5396|114.0|  2025-06-19|        paris|\n| 9952|120.0|  2025-03-14|        paris|\n|12192| 72.0|  2025-07-02|new-york-city|\n|13035|145.0|  2025-09-17|       austin|\n|14124|176.0|  2025-06-18|  los-angeles|\n|14325| 75.0|  2025-09-24|       berlin|\n|16644| 77.0|  2025-03-16|       berlin|\n|17037|273.0|  2025-11-02|new-york-city|\n|17904| 32.0|  2025-09-24|       berlin|\n|18433| 62.0|  2025-09-02|  los-angeles|\n|19887| 90.0|  2025-09-02|  los-angeles|\n|20858|202.0|  2025-09-24|       berlin|\n|26082| 57.0|  2025-09-02|  los-angeles|\n|26543|260.0|  2025-09-24|       berlin|\n|26827| 78.0|  2025-03-16|        paris|\n|28871| 89.0|  2025-09-11|    amsterdam|\n|29628|143.0|  2025-11-02|new-york-city|\n|29853|176.0|  2025-06-19|        paris|\n|37004| 60.0|  2025-09-24|       berlin|\n|38610|340.0|  2025-09-16|       london|\n+-----+-----+------------+-------------+\nonly showing top 20 rows\n", "type": "stream"}], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6385fb302eb4199e7d55cf9bfe61c5f4", "console": [], "id": "PKri", "outputs": []}, {"code_hash": "e8425b2e7cdf3c726f7a37558e503ca8", "console": [], "id": "Xref", "outputs": []}, {"code_hash": "2bd7126d3e0b8ac5f2734b3019843c00", "console": [], "id": "SFPL", "outputs": []}, {"code_hash": "e5c25a916d1eb1fedffbf54a1f67d614", "console": [], "id": "BYtC", "outputs": []}, {"code_hash": "8f40f19654236b4fcb0f63c4efd5efd2", "console": [], "id": "RGSE", "outputs": []}], "metadata": {"marimo_version": "0.19.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.0%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22%2C%20auto_download%3D%5B%22ipynb%22%2C%20%22html%22%5D)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20pyspark.sql%20import%20SparkSession%0A%20%20%20%20from%20pyspark.sql.types%20import%20DateType%2C%20DoubleType%0A%20%20%20%20import%20pyspark.sql.functions%20as%20F%0A%20%20%20%20return%20DoubleType%2C%20F%2C%20SparkSession%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(SparkSession)%3A%0A%20%20%20%20spark%20%3D%20SparkSession.builder.appName(%22Airbnb%20Listing%20Overview%22)%20%5C%0A%20%20%20%20%20%20%20%20.master(%22local%5B*%5D%22)%20%5C%0A%20%20%20%20%20%20%20%20.getOrCreate()%0A%20%20%20%20return%20(spark%2C)%0A%0A%0A%40app.cell%0Adef%20_(DoubleType%2C%20F%2C%20spark)%3A%0A%20%20%20%20df%20%3D%20(%0A%20%20%20%20%20%20%20%20spark.read.csv(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22.%2Fdata%2Flistings%2F%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20header%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inferSchema%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20quote%3D'%22'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20escape%3D'%22'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20multiLine%3DTrue%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.withColumn(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22filename%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20F.split(F.input_file_name()%2C%20%22%2F%22).getItem(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20F.size(F.split(F.input_file_name()%2C%20%22%2F%22))%20-%201%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.withColumns(%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22city%22%3A%20F.split(%22filename%22%2C%20%22_%22).getItem(1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22price%22%3A%20F.try_to_number(%22price%22%2C%20F.lit(%22%24999%2C999%2C999.99%22)).cast(DoubleType())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20).filter(F.col(%22price%22).isNotNull())%0A%20%20%20%20%20%20%20%20.select(%22id%22%2C%20%22price%22%2C%20%22last_scraped%22%2C%20%22city%22)%0A%20%20%20%20)%0A%0A%20%20%20%20df.show()%0A%20%20%20%20return%20(df%2C)%0A%0A%0A%40app.cell%0Adef%20_(F%2C%20df)%3A%0A%20%20%20%20from%20pyspark.sql.window%20import%20Window%0A%0A%20%20%20%20a%20%3D%20df.withColumn(%22rn%22%2C%20F.row_number().over(Window.partitionBy(%22id%22).orderBy(F.col(%22last_scraped%22).desc()))).filter(F.col(%22rn%22)%20%3D%3D%201).drop(%22rn%22)%0A%20%20%20%20a.show()%0A%20%20%20%20return%20(a%2C)%0A%0A%0A%40app.cell%0Adef%20_(col%2C%20df%2C%20mean)%3A%0A%20%20%20%20from%20pyspark.sql.functions%20import%20regexp_replace%0A%0A%20%20%20%20df%20%5C%0A%20%20%20%20%20%20%20%20.select(%22city%22%2C%20%22price%22%2C%20%22accommodates%22)%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22price%22%2C%20regexp_replace(col(%22price%22)%2C%20%22%5B%24%7C%2C%5D%22%2C%20%22%22).cast(%22double%22))%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22accommodates%22%2C%20col(%22accommodates%22).try_cast(%22integer%22))%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22average%22%2C%20col(%22price%22)%20%2F%20col(%22accommodates%22))%20%5C%0A%20%20%20%20%20%20%20%20.dropna()%20%5C%0A%20%20%20%20%20%20%20%20.groupby(%22city%22)%20%5C%0A%20%20%20%20%20%20%20%20.agg(mean(%22average%22))%20%5C%0A%20%20%20%20%20%20%20%20.explain(True)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20from%20pyspark.sql.functions%20import%20percent_rank%2C%20expr%0A%20%20%20%20%23%20from%20pyspark.sql.window%20import%20Window%0A%0A%20%20%20%20%23%20windowSpec%20%3D%20Window.partitionBy(%22city%22).orderBy(%22average%22)%0A%0A%20%20%20%20%23%20df%20%5C%0A%20%20%20%20%23%20%20%20%20%20.select(%22city%22%2C%20%22price%22%2C%20%22accommodates%22)%20%5C%0A%20%20%20%20%23%20%20%20%20%20.withColumn(%22price%22%2C%20regexp_replace(col(%22price%22)%2C%20%22%5B%24%7C%2C%5D%22%2C%20%22%22).cast(%22double%22))%20%5C%0A%20%20%20%20%23%20%20%20%20%20.withColumn(%22accommodates%22%2C%20col(%22accommodates%22).try_cast(%22integer%22))%20%5C%0A%20%20%20%20%23%20%20%20%20%20.withColumn(%22average%22%2C%20col(%22price%22)%20%2F%20col(%22accommodates%22))%20%5C%0A%20%20%20%20%23%20%20%20%20%20.dropna()%20%5C%0A%20%20%20%20%23%20%20%20%20%20.groupby(%22city%22)%20%5C%0A%20%20%20%20%23%20%20%20%20%20.agg(%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20expr(%22percentile_approx(average%2C%200.25)%22).alias(%22p25%22)%2C%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20expr(%22percentile_approx(average%2C%200.90)%22).alias(%22p90%22)%0A%20%20%20%20%23%20%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(a)%3A%0A%20%20%20%20a.plot.bar(x%3D'PercentRank'%2C%20y%3D'PercentRank')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20df%20%5C%0A%20%20%20%20%20%20%20%20.select(%22city%22%2C%20%22bedrooms%22%2C%20%22price%22)%20%5C%0A%20%20%20%20%20%20%20%20.dropna()%20%5C%0A%20%20%20%20%20%20%20%20.count()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20spark.stop()%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">800b197537b8a382275831937006eb62</marimo-code-hash>
</body>
</html>
