<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>Airbnb.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>Airbnb</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/index-CGfe1Tpd.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/preload-helper-BW0IMuFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/hotkeys-uKX61F1_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/defaultLocale-BLUna9fQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/precisionRound-Cl9k9ZmS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/defaultLocale-DzliDDTm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/vega-loader.browser-C8wT63Va.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/tooltip-CrRUCOBw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/clsx-D0MtrJOx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cn-C1rgT0yh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/react-BGmjiNul.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/compiler-runtime-DeeZ7FnK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/jsx-runtime-DN_bIXfG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/badge-DAnNhy3O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useEventListener-COkmyg1v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/button-DuYGqRtX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/react-dom-C9fstfnp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/Combination-D1TsGrBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/menu-items-9PZrU2e0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CBrDuocE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/createLucideIcon-CW2xpJ57.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/check-CrAQug3q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/select-D0g5GnIs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/tooltip-CvjcEpZC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/use-toast-Bzf3rpev.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseIsEqual-Cz9Tt_-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useEvent-DlWF5OMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/invariant-C6yE60hi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/zod-Cg4WLWh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/utils-CJJIceVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/constants-Bkp4R3bQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/Deferred-DzyBMRsy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/config-babG4OBR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/uuid-ClFZlR7U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/DeferredRequestRegistry-B3BENoUa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/requests-C0HaHO6a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_hasUnicode-zBEpxwYe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useLifecycle-CmDXEyIC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useNonce-EAuSVK-5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useTheme-DfP1CWaW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/once-CTiSlR1m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/capabilities-BmAOeMOK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/createReducer-DDa-hVe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CAcX026F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-DKNOF5xd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CI6_zMIl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-BVf1IY4_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-Cq_4nPfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-CVj-_Iiz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-HGZzCB0y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-RKnr9SNh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-BuhT82Xx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/stex-0ac7Aukl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toDate-5JckKRQn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cjs-Bj40p_Np.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_arrayReduce-bZBYsK-u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/type-BdyvjzTI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseProperty-DuoFhI7N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/debounce-BbFlGgjv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/database-zap-CaVvnK_o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/main-CwSdzVhm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cells-D_SkyFDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/ErrorBoundary-Drf1manw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/kbd-Czc5z_04.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useInstallPackage-RldLPyJs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/alert-dialog-k5KxevGr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dialog-DUEuLcT2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDebounce-em3gna-v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/numbers-C9_R_vlY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/SSRProvider-DD7JA3RM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/context-BAYdLMF_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useNumberFormatter-D8ks3oPN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/usePress-C2LPFxyv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/input-CaEtLL8p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/ImperativeModal-q6QlC2aZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cell-link-BoUpLV2S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/multi-map-fjX9ImVF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/alert-BEdExd6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chevron-right-CqEd11Di.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dropdown-menu-BP4_BZLr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/links-DNmjkr65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/datasource-CR_zEq5o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/state-kFdt1US2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/MarimoErrorOutput-Orp0blpZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/copy-DRhpWiOq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/copy-gBVL4NN-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/copy-icon-B69c-352.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/spinner-C1czjtp7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/es-CEEVxHsX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/focus-D18AHojc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/LazyAnyLanguageCodeMirror-jpEDlD0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/katex-AwOI3EvM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/marked.esm-CHnOtnr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chunk-OGVTOU66-CjNLT2C3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/markdown-renderer-C_xfLXiO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dist-DOFFh6Ii.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/command-Qt3ng7cb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/popover-DtnzNVk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useRunCells-BZ_OFvV4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/mode-BFwdGSZ7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/purify.es-N-2faAGj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/RenderHTML-BzGWfPTJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/table--_20dwBZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/tabs-Ctk4D03n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useAsyncData-BJJJOr9W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useIframeCapabilities-CU-WWxnz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/error-banner-DU5Qb8a8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/formats-B9CrBoaO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/en-US-DhMN8sxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/isValid-DhzaK-Y1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/dates-CdsE1R40.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/download-CITws1-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/maps-s2pQkyf5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/extends-B9D0JO9U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/emotion-is-prop-valid.esm-lG8j6oqk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDateFormatter-CV0QXb5P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/range-sshwVRcP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/capitalize-DQeWKRGx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/table-BLx7B_us.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/JsonOutput-BLd1jTNA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/file-BnFXtaZZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/play-BJDBXApx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chat-components-6dWNbFjV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/isEmpty-DIxUV1UR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/circle-check-big-OIMTUpe6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chat-display-Cfg38gMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/ai-model-dropdown-DZ7evAGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/renderShortcut-D0Pei-OA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDeleteCell-GHwc6J4l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/icons-D4lB4En9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/process-output-4w8xDO0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/blob-Dg_vNTSs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/objectWithoutPropertiesLoose-CboCOq4o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/esm-B3JckBtM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/add-cell-with-ai-Dx5UA23s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/chart-no-axes-column-D42sFB6d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/square-function-DxXFdbn8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/spec-qp_XZeSS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/column-preview-9nPwQyJZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/switch-C9iBa4rX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/toggle-G1t0cQyf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/globals-D3SeIm1j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/share-CXQVxivL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseSet-6FYvpjrm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/react-resizable-panels.browser.esm-BqxQegSf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/utilities.esm-FYD46c3d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/floating-outline-p0aHdM2W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useAddCell-CVfRv5mq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/eye-off-D9zAYqG9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/plus-CHesBJpY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/readonly-python-code-DjP4vjBQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/file-video-camera-CZUg-nFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/types-VzFAm7Cv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/label-qwandMoh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/textarea-D2hGxqGj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/refresh-ccw-DbW1_PHb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/trash-2-C-lF7BNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/form-DEraWoX5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/field-DDKGFzpC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useBoolean-5kuXz69O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/useDeepCompareMemoize-gzLRYatP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/types-B42u_5hF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/prop-types-C638SUfx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/es-FiXEquL2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/VisuallyHidden-BodIky8L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/hasIn-DydgU7lx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/_baseFlatten-CLPh0yMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/flatten-Buk63LQO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/pick-DeQioq0G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/code-xml-MBUyxNtK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/download-DobaYJPt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/globe-CY9im410.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/refresh-cw-Din9uFKE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/settings-MTlHVxz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/square-leQTJTJJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/triangle-alert-CbD0f2J6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/bundle.esm-B0Sy2M4C.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.0/dist/assets/index-BQNCH-dG.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "Airbnb.py",
            "mode": "read",
            "version": "0.19.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "full", "reference_highlighting": false, "theme": "dark"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"auto_download": ["ipynb", "html"], "sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "from pyspark.sql import SparkSession\nfrom pyspark.sql.functions import (\n    input_file_name,\n    split,\n    replace,\n    udf,\n    mean,\n    mode,\n    col,\n)", "code_hash": "eb4540014c3beabbf232165ec5d3d75f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "spark = (\n    SparkSession.builder.appName(\"Airbnb Listing Overview\")\n    .config(\"spark.sql.files.maxPartitionBytes\", \"1MB\")\n    .master(\"local[*]\")\n    .getOrCreate()\n)\nspark.sparkContext._jsc.hadoopConfiguration().set(\n    \"fs.file.impl.disable.cache\", \"true\"\n)", "code_hash": "68bb2dfb81f6dd6dcc7ec418dc07e894", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "spark", "code_hash": "98f11b7a7880169c3bd62a5a507b3965", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "# tdf = spark.read.csv(\n#     \"file:/Users/ajinkyaarvindp/Downloads/Fire.csv\",\n#     header=True,\n#     inferSchema=True,\n#     quote='\"',\n#     escape='\"',\n#     multiLine=True,\n# )\n\n# tdf.show()\n\n# tdf.orderBy(\"Battalion\").write_parquet.parquet(path=\"./output\", mode=\"overwrite\")\n\n# print(tdf.rdd.getNumPartitions())\n\n# parquetDf1 = spark.read.parquet(\"./output/\")\n\n# print(parquetDf1.rdd.getNumPartitions())\n\n# parquetDf1.rdd.mapPartitionsWithIndex(\n#     lambda i, it: [(i, list(it)[:1])]\n# ).collect()", "code_hash": "77d70383dba6a834bc7d33364597cd53", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "from pyspark.sql.types import StructType, StructField, StringType\n\nschema = StructType([\n    StructField('id', StringType(), True),\n    StructField('listing_url', StringType(), True),\n    StructField('scrape_id', StringType(), True),\n    StructField('last_scraped', StringType(), True),\n    StructField('source', StringType(), True),\n    StructField('name', StringType(), True),\n    StructField('description', StringType(), True),\n    StructField('neighborhood_overview', StringType(), True),\n    StructField('picture_url', StringType(), True),\n\n    StructField('host_id', StringType(), True),\n    StructField('host_url', StringType(), True),\n    StructField('host_profile_id', StringType(), True),\n    StructField('host_profile_url', StringType(), True),\n    StructField('host_name', StringType(), True),\n    StructField('host_since', StringType(), True),\n    StructField('hosts_time_as_user_years', StringType(), True),\n    StructField('hosts_time_as_user_months', StringType(), True),\n    StructField('hosts_time_as_host_years', StringType(), True),\n    StructField('hosts_time_as_host_months', StringType(), True),\n    StructField('host_location', StringType(), True),\n    StructField('host_about', StringType(), True),\n    StructField('host_response_time', StringType(), True),\n    StructField('host_response_rate', StringType(), True),\n    StructField('host_acceptance_rate', StringType(), True),\n    StructField('host_is_superhost', StringType(), True),\n    StructField('host_thumbnail_url', StringType(), True),\n    StructField('host_picture_url', StringType(), True),\n    StructField('host_neighbourhood', StringType(), True),\n    StructField('host_listings_count', StringType(), True),\n    StructField('host_total_listings_count', StringType(), True),\n    StructField('host_verifications', StringType(), True),\n    StructField('host_has_profile_pic', StringType(), True),\n    StructField('host_identity_verified', StringType(), True),\n\n    StructField('neighbourhood', StringType(), True),\n    StructField('neighbourhood_cleansed', StringType(), True),\n    StructField('neighbourhood_group_cleansed', StringType(), True),\n    StructField('latitude', StringType(), True),\n    StructField('longitude', StringType(), True),\n\n    StructField('property_type', StringType(), True),\n    StructField('room_type', StringType(), True),\n    StructField('accommodates', StringType(), True),\n    StructField('bathrooms', StringType(), True),\n    StructField('bathrooms_text', StringType(), True),\n    StructField('bedrooms', StringType(), True),\n    StructField('beds', StringType(), True),\n    StructField('amenities', StringType(), True),\n    StructField('price', StringType(), True),\n\n    StructField('minimum_nights', StringType(), True),\n    StructField('maximum_nights', StringType(), True),\n    StructField('minimum_minimum_nights', StringType(), True),\n    StructField('maximum_minimum_nights', StringType(), True),\n    StructField('minimum_maximum_nights', StringType(), True),\n    StructField('maximum_maximum_nights', StringType(), True),\n    StructField('minimum_nights_avg_ntm', StringType(), True),\n    StructField('maximum_nights_avg_ntm', StringType(), True),\n\n    StructField('calendar_updated', StringType(), True),\n    StructField('has_availability', StringType(), True),\n    StructField('availability_30', StringType(), True),\n    StructField('availability_60', StringType(), True),\n    StructField('availability_90', StringType(), True),\n    StructField('availability_365', StringType(), True),\n    StructField('calendar_last_scraped', StringType(), True),\n\n    StructField('number_of_reviews', StringType(), True),\n    StructField('number_of_reviews_ltm', StringType(), True),\n    StructField('number_of_reviews_l30d', StringType(), True),\n    StructField('availability_eoy', StringType(), True),\n    StructField('number_of_reviews_ly', StringType(), True),\n    StructField('estimated_occupancy_l365d', StringType(), True),\n    StructField('estimated_revenue_l365d', StringType(), True),\n\n    StructField('first_review', StringType(), True),\n    StructField('last_review', StringType(), True),\n\n    StructField('review_scores_rating', StringType(), True),\n    StructField('review_scores_accuracy', StringType(), True),\n    StructField('review_scores_cleanliness', StringType(), True),\n    StructField('review_scores_checkin', StringType(), True),\n    StructField('review_scores_communication', StringType(), True),\n    StructField('review_scores_location', StringType(), True),\n    StructField('review_scores_value', StringType(), True),\n\n    StructField('license', StringType(), True),\n    StructField('instant_bookable', StringType(), True),\n\n    StructField('calculated_host_listings_count', StringType(), True),\n    StructField('calculated_host_listings_count_entire_homes', StringType(), True),\n    StructField('calculated_host_listings_count_private_rooms', StringType(), True),\n    StructField('calculated_host_listings_count_shared_rooms', StringType(), True),\n    StructField('reviews_per_month', StringType(), True)\n])\n\nlen(schema.fieldNames())", "code_hash": "ddde1f80d2855976657bbb7c2c31a951", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "df = (\n    spark.read.csv(\n        \"./data/listings/\",\n        header=True,\n        # schema=schema,\n        inferSchema=True,\n        quote='\"',\n        escape='\"',\n        # enforceSchema=True,\n\n        multiLine=True,\n    )\n    .withColumn(\"city\", split(input_file_name(), \"/\").getItem(10))\n    .withColumn(\"city\", split(col(\"city\"), \"_\").getItem(0))\n)\n\ndf.show()", "code_hash": "a661dd9c093ae481be0cd2b756f28537", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "from pyspark.sql.functions import regexp_replace\n\ndf \\\n    .select(\"city\", \"price\", \"accommodates\") \\\n    .withColumn(\"price\", regexp_replace(col(\"price\"), \"[$|,]\", \"\").cast(\"double\")) \\\n    .withColumn(\"accommodates\", col(\"accommodates\").try_cast(\"integer\")) \\\n    .withColumn(\"average\", col(\"price\") / col(\"accommodates\")) \\\n    .dropna() \\\n    .groupby(\"city\") \\\n    .agg(mean(\"average\")) \\\n    .explain(True)", "code_hash": "6385fb302eb4199e7d55cf9bfe61c5f4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "from pyspark.sql.functions import percent_rank, expr\nfrom pyspark.sql.window import Window\n\nwindowSpec = Window.partitionBy(\"city\").orderBy(\"average\")\n\ndf \\\n    .select(\"city\", \"price\", \"accommodates\") \\\n    .withColumn(\"price\", regexp_replace(col(\"price\"), \"[$|,]\", \"\").cast(\"double\")) \\\n    .withColumn(\"accommodates\", col(\"accommodates\").try_cast(\"integer\")) \\\n    .withColumn(\"average\", col(\"price\") / col(\"accommodates\")) \\\n    .dropna() \\\n    .groupby(\"city\") \\\n    .agg(\n        expr(\"percentile_approx(average, 0.25)\").alias(\"p25\"),\n        expr(\"percentile_approx(average, 0.90)\").alias(\"p90\")\n    )", "code_hash": "b372846f4520d2a751b95094e6000f6c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "a.plot.bar(x='PercentRank', y='PercentRank')", "code_hash": "2bd7126d3e0b8ac5f2734b3019843c00", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "df \\\n    .select(\"city\", \"bedrooms\", \"price\") \\\n    .dropna() \\\n    .count()", "code_hash": "e5c25a916d1eb1fedffbf54a1f67d614", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "# spark.stop()", "code_hash": "8f40f19654236b4fcb0f63c4efd5efd2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}], "metadata": {"marimo_version": "0.19.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "eb4540014c3beabbf232165ec5d3d75f", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "68bb2dfb81f6dd6dcc7ec418dc07e894", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "WARNING: Using incubator modules: jdk.incubator.vector\nUsing Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties\n26/01/13 15:39:37 WARN Utils: Your hostname, Ajinkyas-MacBook-Pro.local, resolves to a loopback address: 127.0.0.1; using 192.168.1.52 instead (on interface en0)\n26/01/13 15:39:37 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address\nUsing Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n26/01/13 15:39:38 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n", "type": "stream"}], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "98f11b7a7880169c3bd62a5a507b3965", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "\n            \u003Cdiv\u003E\n                \u003Cp\u003E\u003Cb\u003ESparkSession - in-memory\u003C/b\u003E\u003C/p\u003E\n                \n        \u003Cdiv\u003E\n            \u003Cp\u003E\u003Cb\u003ESparkContext\u003C/b\u003E\u003C/p\u003E\n\n            \u003Cp\u003E\u003Ca href=\"http://192.168.1.52:4040\"\u003ESpark UI\u003C/a\u003E\u003C/p\u003E\n\n            \u003Cdl\u003E\n              \u003Cdt\u003EVersion\u003C/dt\u003E\n                \u003Cdd\u003E\u003Ccode\u003Ev4.1.0\u003C/code\u003E\u003C/dd\u003E\n              \u003Cdt\u003EMaster\u003C/dt\u003E\n                \u003Cdd\u003E\u003Ccode\u003Elocal[*]\u003C/code\u003E\u003C/dd\u003E\n              \u003Cdt\u003EAppName\u003C/dt\u003E\n                \u003Cdd\u003E\u003Ccode\u003EAirbnb Listing Overview\u003C/code\u003E\u003C/dd\u003E\n            \u003C/dl\u003E\n        \u003C/div\u003E\n        \n            \u003C/div\u003E\n        "}, "type": "data"}]}, {"code_hash": "77d70383dba6a834bc7d33364597cd53", "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ddde1f80d2855976657bbb7c2c31a951", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E85\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "a661dd9c093ae481be0cd2b756f28537", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "\r[Stage 1:\u003E                                                          (0 + 9) / 9]\r\r[Stage 1:======\u003E                                                    (1 + 8) / 9]\r\r[Stage 1:=============\u003E                                             (2 + 7) / 9]\r\r[Stage 1:==========================\u003E                                (4 + 5) / 9]\r\r[Stage 1:====================================================\u003E      (8 + 1) / 9]\r\r                                                                                \r26/01/13 15:39:47 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "+------+--------------------+--------------+------------+---------------+--------------------+--------------------+---------------------+--------------------+-------+--------------------+--------------+----------+--------------------+--------------------+------------------+------------------+--------------------+-----------------+--------------------+--------------------+--------------------+-------------------+-------------------------+--------------------+--------------------+----------------------+--------------------+----------------------+----------------------------+------------------+--------------------+--------------------+---------------+------------+---------+----------------+--------+----+--------------------+-------+--------------+--------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------+----------------+---------------+---------------+---------------+----------------+---------------------+-----------------+---------------------+----------------------+----------------+--------------------+-------------------------+-----------------------+------------+-----------+--------------------+----------------------+-------------------------+---------------------+---------------------------+----------------------+-------------------+-------+----------------+------------------------------+-------------------------------------------+--------------------------------------------+-------------------------------------------+-----------------+----------+\n|    id|         listing_url|     scrape_id|last_scraped|         source|                name|         description|neighborhood_overview|         picture_url|host_id|            host_url|     host_name|host_since|       host_location|          host_about|host_response_time|host_response_rate|host_acceptance_rate|host_is_superhost|  host_thumbnail_url|    host_picture_url|  host_neighbourhood|host_listings_count|host_total_listings_count|  host_verifications|host_has_profile_pic|host_identity_verified|       neighbourhood|neighbourhood_cleansed|neighbourhood_group_cleansed|          latitude|           longitude|       property_type|      room_type|accommodates|bathrooms|  bathrooms_text|bedrooms|beds|           amenities|  price|minimum_nights|maximum_nights|minimum_minimum_nights|maximum_minimum_nights|minimum_maximum_nights|maximum_maximum_nights|minimum_nights_avg_ntm|maximum_nights_avg_ntm|calendar_updated|has_availability|availability_30|availability_60|availability_90|availability_365|calendar_last_scraped|number_of_reviews|number_of_reviews_ltm|number_of_reviews_l30d|availability_eoy|number_of_reviews_ly|estimated_occupancy_l365d|estimated_revenue_l365d|first_review|last_review|review_scores_rating|review_scores_accuracy|review_scores_cleanliness|review_scores_checkin|review_scores_communication|review_scores_location|review_scores_value|license|instant_bookable|calculated_host_listings_count|calculated_host_listings_count_entire_homes|calculated_host_listings_count_private_rooms|calculated_host_listings_count_shared_rooms|reviews_per_month|      city|\n+------+--------------------+--------------+------------+---------------+--------------------+--------------------+---------------------+--------------------+-------+--------------------+--------------+----------+--------------------+--------------------+------------------+------------------+--------------------+-----------------+--------------------+--------------------+--------------------+-------------------+-------------------------+--------------------+--------------------+----------------------+--------------------+----------------------+----------------------------+------------------+--------------------+--------------------+---------------+------------+---------+----------------+--------+----+--------------------+-------+--------------+--------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------+----------------+---------------+---------------+---------------+----------------+---------------------+-----------------+---------------------+----------------------+----------------+--------------------+-------------------------+-----------------------+------------+-----------+--------------------+----------------------+-------------------------+---------------------+---------------------------+----------------------+-------------------+-------+----------------+------------------------------+-------------------------------------------+--------------------------------------------+-------------------------------------------+-----------------+----------+\n|264776|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Huge Four Bedroom...|An extremely larg...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44306|            -0.01948|  Entire rental unit|Entire home/apt|          10|      2.0|         2 baths|     4.0|   8|[\"Cooking basics\"...|$297.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|             13|             15|           31.0|           293.0|           2025-06-11|               68|                   12|                     1|             134|                  15|                      110|                32670.0|  2014-07-03| 2025-05-28|                4.68|                  4.65|                     4.72|                 4.84|                       4.74|                  4.62|               4.72|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.51|2025-06-10|\n|264777|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|One Bedroom Apart...|Recently refurbis...|                 NULL|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|                NULL|              Lewisham|                        NULL|          51.44284|            -0.01997|  Entire rental unit|Entire home/apt|           2|      1.0|          1 bath|     1.0|   2|[\"Cooking basics\"...| $98.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              0|             13|           43.0|           318.0|           2025-06-11|               24|                    4|                     0|             157|                   7|                       37|                 3626.0|  2016-07-21| 2024-12-11|                4.58|                  4.42|                     4.54|                 4.58|                       4.25|                  4.54|               4.42|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.22|2025-06-10|\n|264778|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Two Bedroom Newly...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44359|            -0.02275|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     2.0|   3|[\"Cooking basics\"...|$148.00|           3.0|           365|                     1|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              3|              6|           27.0|           302.0|           2025-06-11|               58|                    6|                     0|             141|                   8|                       55|                 8140.0|  2014-04-21| 2025-05-01|                 4.5|                   4.5|                     4.45|                 4.72|                       4.52|                  4.36|               4.38|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.43|2025-06-10|\n|264779|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Refurbished Two B...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44355|            -0.02309|  Entire rental unit|Entire home/apt|           5|      1.0|          1 bath|     2.0|   5|[\"Cooking basics\"...|$144.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|             11|             33|           53.0|           328.0|           2025-06-11|               36|                    7|                     0|             167|                   7|                       64|                 9216.0|  2015-07-23| 2025-04-10|                4.64|                  4.67|                     4.58|                 4.83|                       4.61|                   4.5|               4.47|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.30|2025-06-10|\n|264780|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Spacious refurbis...|Completely refurb...|                 NULL|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|                NULL|              Lewisham|                        NULL|          51.44333|            -0.02307|  Entire rental unit|Entire home/apt|           4|      2.0|         2 baths|     2.0|   4|[\"Cooking basics\"...|$157.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              0|              9|           11.0|           255.0|           2025-06-11|               54|                    4|                     0|             101|                   7|                       37|                 5809.0|  2012-09-18| 2024-12-29|                4.68|                  4.78|                     4.65|                 4.81|                       4.74|                  4.37|               4.59|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.35|2025-06-10|\n|264781|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Two Bedrooms Gard...|A two bedroom, 2 ...| Catford is an up ...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44204|            -0.02149|  Entire rental unit|Entire home/apt|           3|      2.0|         2 baths|     2.0|   2|[\"Cooking basics\"...|$148.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              2|              2|           27.0|           274.0|           2025-06-11|                8|                    0|                     0|             113|                   0|                        0|                    0.0|  2017-10-23| 2023-08-12|                3.88|                  4.13|                     3.75|                 4.88|                       4.63|                   4.5|               4.13|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.09|2025-06-10|\n|264782|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|One Bedroom Garde...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44353|            -0.02328|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     1.0|   3|[\"Cooking basics\"...|$120.00|           4.0|           365|                     4|                     4|                  1125|                  1125|                   4.0|                1125.0|            NULL|               t|              6|             23|           48.0|           323.0|           2025-06-11|               17|                    4|                     1|             162|                   4|                       37|                 4440.0|  2018-06-30| 2025-05-20|                4.59|                  4.53|                     4.47|                 4.76|                       4.71|                  4.53|               4.65|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.20|2025-06-10|\n|264783|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Four Bedroom Gard...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44151|            -0.02195|  Entire rental unit|Entire home/apt|           7|      2.0|         2 baths|     4.0|   6|[\"Cooking basics\"...|$216.00|           4.0|           365|                     4|                     4|                  1125|                  1125|                   4.0|                1125.0|            NULL|               t|              6|             17|           29.0|           295.0|           2025-06-11|               44|                    4|                     0|             134|                   4|                       37|                 7992.0|  2013-10-07| 2025-05-04|                4.64|                   4.5|                     4.43|                 4.75|                       4.77|                  4.52|               4.48|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.31|2025-06-10|\n|264789|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Huge Three Bedroo...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44346|            -0.02122|  Entire rental unit|Entire home/apt|           7|      2.0|         2 baths|     3.0|   4|[\"Cooking basics\"...|$238.00|           3.0|           365|                     4|                     4|                  1125|                  1125|                   4.0|                1125.0|            NULL|               t|             17|             27|           47.0|           322.0|           2025-06-11|               65|                   12|                     0|             161|                  16|                      110|                26180.0|  2015-02-15| 2025-04-19|                4.72|                  4.68|                     4.54|                 4.97|                       4.88|                  4.49|               4.68|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.52|2025-06-10|\n|266037|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Central London wi...|We've welcomed ov...| Our local area ha...|https://a0.muscac...|1395281|https://www.airbn...|         James|2011-11-11|England, United K...|I'm a culture vul...|within a few hours|              100%|                100%|                t|https://a0.muscac...|https://a0.muscac...|         St. Pancras|                  1|                        3|  ['email', 'phone']|                   t|                     t|Neighborhood high...|                Camden|                        NULL|          51.52617|             -0.1302|Private room in r...|   Private room|           1|      1.5|1.5 shared baths|     1.0|   1|[\"Washer\", \"Iron\"...| $62.00|           7.0|            90|                     7|                     7|                    90|                    90|                   7.0|                  90.0|            NULL|               t|              1|              2|            2.0|            27.0|           2025-06-12|              532|                   18|                     1|              27|                  17|                      252|                15624.0|  2011-11-20| 2025-05-15|                 4.9|                  4.88|                     4.86|                 4.92|                       4.92|                  4.94|               4.84|   NULL|               f|                           1.0|                                        0.0|                                         1.0|                                        0.0|             3.22|2025-06-10|\n|268398|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Also five minutes...|This is a clean a...| This is central L...|https://a0.muscac...| 979363|https://www.airbn...|       Donovan|2011-08-16|London, United Ki...|I am Donovan and ...|    within an hour|              100%|                100%|                t|https://a0.muscac...|https://a0.muscac...|          South Bank|                  6|                        7|  ['email', 'phone']|                   t|                     t|Neighborhood high...|               Lambeth|                        NULL|          51.50287|            -0.10937|Private room in r...|   Private room|           2|      1.5|1.5 shared baths|     1.0|   2|[\"Cooking basics\"...| $66.00|           1.0|          1125|                     1|                     1|                  1125|                  1125|                   1.0|                1125.0|            NULL|               t|              2|              6|           14.0|           104.0|           2025-06-12|              563|                    4|                     1|              86|                  15|                       37|                 2442.0|  2011-12-09| 2025-05-15|                4.63|                  4.72|                     4.76|                 4.68|                       4.75|                  4.82|               4.56|   NULL|               t|                           6.0|                                        1.0|                                         5.0|                                        0.0|             3.42|2025-06-10|\n|270600|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Patio Apartment i...|This immaculate p...|                 NULL|https://a0.muscac...|1416605|https://www.airbn...|          Emma|2011-11-17|London, United Ki...|Hi there,\\r\\n\\r\\n...|    within an hour|              100%|                100%|                t|https://a0.muscac...|https://a0.muscac...|                NULL|                  3|                        3|  ['email', 'phone']|                   t|                     t|                NULL|  Richmond upon Thames|                        NULL|          51.44311|            -0.33245|  Entire rental unit|Entire home/apt|           3|      1.0|          1 bath|     1.0|   1|[\"Cooking basics\"...| $73.00|           4.0|          9011|                     4|                     4|                  9011|                  9011|                   4.0|                9011.0|            NULL|               t|              0|              0|            0.0|           204.0|           2025-06-11|               88|                    7|                     0|              43|                   9|                       64|                 4672.0|  2013-07-17| 2025-04-15|                4.64|                  4.68|                     4.76|                 4.94|                       4.94|                  4.92|               4.58|   NULL|               t|                           3.0|                                        2.0|                                         1.0|                                        0.0|             0.61|2025-06-10|\n|271122|https://www.airbn...|20250610032232|  2025-06-13|previous scrape|Heathrow BNB - Ho...|This room is by f...|                 NULL|https://a0.muscac...|1419096|https://www.airbn...|       Claudia|2011-11-18|Michigan, United ...|I'm from a black ...|               N/A|               N/A|                 N/A|                f|https://a0.muscac...|https://a0.muscac...|    LB of Hillingdon|                  4|                        4|  ['email', 'phone']|                   t|                     f|                NULL|            Hillingdon|                        NULL|          51.53097|            -0.39891|Private room in home|   Private room|           2|     NULL|          1 bath|    NULL|NULL|[\"Lock on bedroom...|   NULL|           1.0|           365|                     1|                     1|                   365|                   365|                   1.0|                 365.0|            NULL|               t|              0|              0|            0.0|             0.0|           2025-06-13|                7|                    0|                     0|               0|                   0|                        0|                   NULL|  2013-06-28| 2017-05-27|                4.14|                  3.86|                     4.57|                 4.71|                       4.29|                  4.14|                4.0|   NULL|               t|                           4.0|                                        1.0|                                         3.0|                                        0.0|             0.05|2025-06-10|\n|425143|https://www.airbn...|20250610032232|  2025-06-13|previous scrape|luxury 1bed in Ch...|                NULL|                 NULL|https://a0.muscac...|2011372|https://www.airbn...|        Cagdas|2012-03-26|London, United Ki...|Hi everyone,\\r\\nI...|               N/A|               N/A|                 N/A|                f|https://a0.muscac...|https://a0.muscac...|           Nine Elms|                  1|                        1|  ['email', 'phone']|                   t|                     t|                NULL|            Wandsworth|                        NULL|          51.48295|             -0.1476|  Entire rental unit|Entire home/apt|           3|     NULL|          1 bath|     1.0|NULL|[\"Washer\", \"Iron\"...|   NULL|           3.0|          1125|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              0|              0|            0.0|             0.0|           2025-06-13|               34|                    0|                     0|               0|                   0|                        0|                   NULL|  2012-07-03| 2017-03-01|                4.88|                  4.88|                     4.67|                 4.88|                       4.94|                  4.78|               4.73|   NULL|               f|                           1.0|                                        1.0|                                         0.0|                                        0.0|             0.22|2025-06-10|\n|426351|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|2 Bed Edwardian M...|Great space to se...| I live in a frien...|https://a0.muscac...|2119157|https://www.airbn...|       Majella|2012-04-11|London, United Ki...|I like to experie...|    within an hour|              100%|                100%|                f|https://a0.muscac...|https://a0.muscac...|         LB of Brent|                  2|                        4|['email', 'phone'...|                   t|                     f|Neighborhood high...|                 Brent|                        NULL|          51.55814|            -0.22465|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     2.0|   2|[\"Cooking basics\"...|$134.00|           3.0|            21|                     3|                     3|                    21|                    21|                   3.0|                  21.0|            NULL|               t|              9|             22|           48.0|           323.0|           2025-06-12|                7|                    0|                     0|             161|                   0|                        0|                    0.0|  2013-11-19| 2023-07-25|                4.71|                  4.71|                     4.43|                 4.86|                       4.86|                  4.43|               4.43|   NULL|               f|                           2.0|                                        1.0|                                         1.0|                                        0.0|             0.05|2025-06-10|\n|426354|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|1 bedroom flat wi...|My one bedroom fl...| Portobello Road a...|https://a0.muscac...|2119740|https://www.airbn...|         Andr\u00e9|2012-04-11|London, United Ki...|I'm from Sweden b...|within a few hours|              100%|                100%|                f|https://a0.muscac...|https://a0.muscac...|RB of Kensington ...|                  1|                        1|  ['email', 'phone']|                   t|                     t|Neighborhood high...|  Kensington and Ch...|                        NULL|          51.52538|            -0.21057|  Entire rental unit|Entire home/apt|           2|      1.0|          1 bath|     1.0|   4|[\"Cooking basics\"...|$200.00|           5.0|             9|                     5|                     5|                     9|                     9|                   5.0|                   9.0|            NULL|               t|              0|              0|            9.0|            44.0|           2025-06-12|               13|                    2|                     0|              40|                   2|                       20|                 4000.0|  2012-04-19| 2024-12-16|                4.92|                   5.0|                      5.0|                  5.0|                        5.0|                  4.73|                5.0|   NULL|               f|                           1.0|                                        1.0|                                         0.0|                                        0.0|             0.08|2025-06-10|\n|427229|https://www.airbn...|20250610032232|  2025-06-13|previous scrape|    Kitchener House!|                NULL|                 NULL|https://a0.muscac...|2087745|https://www.airbn...|          Tony|2012-04-07|London, United Ki...|I am a London tea...|               N/A|               N/A|                 N/A|                f|https://a0.muscac...|https://a0.muscac...|     RB of Greenwich|                  2|                        2|  ['email', 'phone']|                   t|                     f|                NULL|             Greenwich|                        NULL|          51.47574|             0.05733|Private room in r...|   Private room|           1|     NULL|            NULL|     1.0|NULL|                  []|   NULL|           1.0|          1125|                     1|                     1|                  1125|                  1125|                   1.0|                1125.0|            NULL|            NULL|              0|              0|            0.0|             0.0|           2025-06-13|                0|                    0|                     0|               0|                   0|                        0|                   NULL|        NULL|       NULL|                NULL|                  NULL|                     NULL|                 NULL|                       NULL|                  NULL|               NULL|   NULL|               f|                           2.0|                                        1.0|                                         1.0|                                        0.0|             NULL|2025-06-10|\n|427327|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Cool shoreditch c...|                NULL|                 NULL|https://a0.muscac...|2124088|https://www.airbn...|       Corrine|2012-04-12|London, United Ki...|Art Director \u0026 Pr...|      within a day|              100%|                 71%|                f|https://a0.muscac...|https://a0.muscac...|          Shoreditch|                  3|                        7|['email', 'phone'...|                   t|                     t|                NULL|               Hackney|                        NULL|          51.52412|            -0.07869|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     1.0|   1|[\"TV\", \"Essentials\"]|$155.00|           3.0|            64|                     3|                     3|                    64|                    64|                   3.0|                  64.0|            NULL|               t|              0|              3|           33.0|           308.0|           2025-06-12|                0|                    0|                     0|             146|                   0|                        0|                    0.0|        NULL|       NULL|                NULL|                  NULL|                     NULL|                 NULL|                       NULL|                  NULL|               NULL|   NULL|               f|                           1.0|                                        1.0|                                         0.0|                                        0.0|             NULL|2025-06-10|\n|427348|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Lovely 2 bedroom ...|Modern, luminous ...| Brixton is a live...|https://a0.muscac...|2124185|https://www.airbn...|Graham \u0026 Ivano|2012-04-12|London, United Ki...|We are a couple b...|      within a day|              100%|                 33%|                f|https://a0.muscac...|https://a0.muscac...|          Herne Hill|                  2|                        3|  ['email', 'phone']|                   t|                     t|Neighborhood high...|               Lambeth|                        NULL|          51.46837|            -0.09851|        Entire condo|Entire home/apt|           5|      2.0|         2 baths|     2.0|   2|[\"Cooking basics\"...|$135.00|           7.0|            12|                     9|                     9|                    12|                    12|                   9.0|                  12.0|            NULL|               t|              8|             32|           62.0|           152.0|           2025-06-12|               23|                    0|                     0|             152|                   0|                        0|                    0.0|  2013-01-03| 2023-01-03|                4.77|                  4.78|                     4.39|                 4.78|                       4.78|                  4.48|               4.65|   NULL|               f|                           2.0|                                        1.0|                                         1.0|                                        0.0|             0.15|2025-06-10|\n|427584|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Hackney Stylish \u0026...|Very bright and s...| An abundance of c...|https://a0.muscac...|2125123|https://www.airbn...|        Sophie|2012-04-12|London, United Ki...|Hi my name is Sop...|    within an hour|              100%|                 91%|                t|https://a0.muscac...|https://a0.muscac...|             Dalston|                 10|                       35|  ['email', 'phone']|                   t|                     t|Neighborhood high...|               Hackney|                        NULL|51.547550201416016|-0.06635300070047379|        Entire condo|Entire home/apt|           3|      1.0|          1 bath|     1.0|   1|[\"Cooking basics\"...|$129.00|           5.0|           300|                     2|                     6|                   300|                   300|                   5.2|                 300.0|            NULL|               t|              2|              5|           17.0|           100.0|           2025-06-12|              152|                    6|                     0|             100|                  10|                       60|                 7740.0|  2012-06-20| 2024-09-24|                4.65|                   4.7|                     4.64|                 4.84|                       4.91|                  4.75|               4.61|   NULL|               t|                           5.0|                                        5.0|                                         0.0|                                        0.0|             0.96|2025-06-10|\n+------+--------------------+--------------+------------+---------------+--------------------+--------------------+---------------------+--------------------+-------+--------------------+--------------+----------+--------------------+--------------------+------------------+------------------+--------------------+-----------------+--------------------+--------------------+--------------------+-------------------+-------------------------+--------------------+--------------------+----------------------+--------------------+----------------------+----------------------------+------------------+--------------------+--------------------+---------------+------------+---------+----------------+--------+----+--------------------+-------+--------------+--------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------+----------------+---------------+---------------+---------------+----------------+---------------------+-----------------+---------------------+----------------------+----------------+--------------------+-------------------------+-----------------------+------------+-----------+--------------------+----------------------+-------------------------+---------------------+---------------------------+----------------------+-------------------+-------+----------------+------------------------------+-------------------------------------------+--------------------------------------------+-------------------------------------------+-----------------+----------+\nonly showing top 20 rows\n", "type": "stream"}], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6385fb302eb4199e7d55cf9bfe61c5f4", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "== Parsed Logical Plan ==\n'Aggregate ['city], ['city, unresolvedalias('avg('average))]\n+- Filter atleastnnonnulls(4, city#81, price#402, accommodates#403, average#404)\n   +- Project [city#81, price#402, accommodates#403, (price#402 / cast(accommodates#403 as double)) AS average#404]\n      +- Project [city#81, price#402, try_cast(accommodates#34 as int) AS accommodates#403]\n         +- Project [city#81, cast(regexp_replace(price#40, [$|,], , 1) as double) AS price#402, accommodates#34]\n            +- Project [city#81, price#40, accommodates#34]\n               +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                  +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                     +- Relation [id#0L,listing_url#1,scrape_id#2L,last_scraped#3,source#4,name#5,description#6,neighborhood_overview#7,picture_url#8,host_id#9,host_url#10,host_name#11,host_since#12,host_location#13,host_about#14,host_response_time#15,host_response_rate#16,host_acceptance_rate#17,host_is_superhost#18,host_thumbnail_url#19,host_picture_url#20,host_neighbourhood#21,host_listings_count#22,host_total_listings_count#23,host_verifications#24,... 54 more fields] csv\n\n== Analyzed Logical Plan ==\ncity: string, avg(average): double\nAggregate [city#81], [city#81, avg(average#404) AS avg(average)#410]\n+- Filter atleastnnonnulls(4, city#81, price#402, accommodates#403, average#404)\n   +- Project [city#81, price#402, accommodates#403, (price#402 / cast(accommodates#403 as double)) AS average#404]\n      +- Project [city#81, price#402, try_cast(accommodates#34 as int) AS accommodates#403]\n         +- Project [city#81, cast(regexp_replace(price#40, [$|,], , 1) as double) AS price#402, accommodates#34]\n            +- Project [city#81, price#40, accommodates#34]\n               +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                  +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                     +- Relation [id#0L,listing_url#1,scrape_id#2L,last_scraped#3,source#4,name#5,description#6,neighborhood_overview#7,picture_url#8,host_id#9,host_url#10,host_name#11,host_since#12,host_location#13,host_about#14,host_response_time#15,host_response_rate#16,host_acceptance_rate#17,host_is_superhost#18,host_thumbnail_url#19,host_picture_url#20,host_neighbourhood#21,host_listings_count#22,host_total_listings_count#23,host_verifications#24,... 54 more fields] csv\n\n== Optimized Logical Plan ==\nAggregate [city#81], [city#81, avg(average#404) AS avg(average)#410]\n+- Project [split(city#80, _, -1)[0] AS city#81, (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)) AS average#404]\n   +- Filter atleastnnonnulls(4, split(city#80, _, -1)[0], cast(regexp_replace(price#40, [$|,], , 1) as double), try_cast(accommodates#34 as int), (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)))\n      +- Project [accommodates#34, price#40, split(input_file_name(), /, -1)[10] AS city#80]\n         +- Relation [id#0L,listing_url#1,scrape_id#2L,last_scraped#3,source#4,name#5,description#6,neighborhood_overview#7,picture_url#8,host_id#9,host_url#10,host_name#11,host_since#12,host_location#13,host_about#14,host_response_time#15,host_response_rate#16,host_acceptance_rate#17,host_is_superhost#18,host_thumbnail_url#19,host_picture_url#20,host_neighbourhood#21,host_listings_count#22,host_total_listings_count#23,host_verifications#24,... 54 more fields] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- HashAggregate(keys=[city#81], functions=[avg(average#404)], output=[city#81, avg(average)#410])\n   +- Exchange hashpartitioning(city#81, 200), ENSURE_REQUIREMENTS, [plan_id=38]\n      +- HashAggregate(keys=[city#81], functions=[partial_avg(average#404)], output=[city#81, sum#413, count#414L])\n         +- Project [split(city#80, _, -1)[0] AS city#81, (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)) AS average#404]\n            +- Filter atleastnnonnulls(4, split(city#80, _, -1)[0], cast(regexp_replace(price#40, [$|,], , 1) as double), try_cast(accommodates#34 as int), (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)))\n               +- Project [accommodates#34, price#40, split(input_file_name(), /, -1)[10] AS city#80]\n                  +- FileScan csv [accommodates#34,price#40] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/Users/ajinkyaarvindp/Home/Work/spark/data/listings], PartitionFilters: [], PushedFilters: [], ReadSchema: struct\u003Caccommodates:string,price:string\u003E\n\n", "type": "stream"}], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b372846f4520d2a751b95094e6000f6c", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='BYtC-0' random-id='9f241db7-8aa2-ac96-95fd-a1fc0471a46d'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='[]' data-total-rows='\u0026quot;too_many\u0026quot;' data-total-columns='0' data-max-columns='50' data-banner-text='\u0026quot;Previewing only the first 10 rows.\u0026quot;' data-pagination='false' data-page-size='10' data-show-filters='true' data-show-download='false' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='true' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "2bd7126d3e0b8ac5f2734b3019843c00", "console": [{"mimetype": "application/vnd.marimo+traceback", "name": "stderr", "text": "\u003Cspan class=\"codehilite\"\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Cspan class=\"gt\"\u003ETraceback (most recent call last):\u003C/span\u003E\n  File \u003Cspan class=\"nb\"\u003E\u0026quot;/var/folders/vt/wzvpy6nx2575z7q8v90zrhhr0000gn/T/marimo_9031/__marimo__cell_RGSE_.py\u0026quot;\u003C/span\u003E, line \u003Cspan class=\"m\"\u003E1\u003C/span\u003E, in \u003Cspan class=\"n\"\u003E\u0026lt;module\u0026gt;\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E    \u003C/span\u003E\u003Cspan class=\"n\"\u003Ea\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eplot\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Ebar\u003C/span\u003E\u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003Ex\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s1\"\u003E\u0026#39;PercentRank\u0026#39;\u003C/span\u003E\u003Cspan class=\"p\"\u003E,\u003C/span\u003E \u003Cspan class=\"n\"\u003Ey\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s1\"\u003E\u0026#39;PercentRank\u0026#39;\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E    \u003C/span\u003E\u003Cspan class=\"pm\"\u003E^\u003C/span\u003E\n\u003Cspan class=\"gr\"\u003ENameError\u003C/span\u003E: \u003Cspan class=\"n\"\u003Ename \u0026#39;a\u0026#39; is not defined\u003C/span\u003E\n\u003C/pre\u003E\u003C/div\u003E\n\u003C/span\u003E", "type": "stream"}], "id": "RGSE", "outputs": [{"ename": "exception", "evalue": "name 'a' is not defined", "traceback": [], "type": "error"}]}, {"code_hash": "e5c25a916d1eb1fedffbf54a1f67d614", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "26/01/13 15:39:47 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-12-04_los-angeles_listings.csv.gz\n\r[Stage 3:\u003E                                                        (0 + 11) / 67]\r\r[Stage 3:\u003E                                                        (1 + 11) / 67]\r26/01/13 15:39:49 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-01-03_new-york-city_listings.csv.gz\n\r[Stage 3:===\u003E                                                     (4 + 11) / 67]\r26/01/13 15:39:49 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-12-04_new-york-city_listings.csv.gz\n\r[Stage 3:====\u003E                                                    (5 + 11) / 67]\r\r[Stage 3:=======\u003E                                                 (9 + 11) / 67]\r\r[Stage 3:=============\u003E                                          (16 + 11) / 67]\r\r[Stage 3:===============\u003E                                        (18 + 11) / 67]\r26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2024-12-27_mexico-city_listings.csv.gz\n26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2024-12-25_bangkok_listings.csv.gz\n26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2024-12-30_tokyo_listings.csv.gz\n26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-01-09_toronto_listings.csv.gz\n\r[Stage 3:======================\u003E                                 (27 + 11) / 67]\r\r[Stage 3:==============================\u003E                         (37 + 11) / 67]\r\r[Stage 3:===============================\u003E                        (38 + 11) / 67]\r\r[Stage 3:======================================\u003E                 (46 + 12) / 67]\r\r[Stage 3:========================================\u003E               (49 + 11) / 67]\r26/01/13 15:39:51 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-12-04_san-francisco_listings.csv.gz\n\r                                                                                \r", "type": "stream"}], "id": "Kclp", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E1366276\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "8f40f19654236b4fcb0f63c4efd5efd2", "console": [], "id": "emfo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.0%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22%2C%20auto_download%3D%5B%22ipynb%22%2C%20%22html%22%5D)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20pyspark.sql%20import%20SparkSession%0A%20%20%20%20from%20pyspark.sql.functions%20import%20(%0A%20%20%20%20%20%20%20%20input_file_name%2C%0A%20%20%20%20%20%20%20%20split%2C%0A%20%20%20%20%20%20%20%20replace%2C%0A%20%20%20%20%20%20%20%20udf%2C%0A%20%20%20%20%20%20%20%20mean%2C%0A%20%20%20%20%20%20%20%20mode%2C%0A%20%20%20%20%20%20%20%20col%2C%0A%20%20%20%20)%0A%20%20%20%20return%20SparkSession%2C%20col%2C%20input_file_name%2C%20mean%2C%20split%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(SparkSession)%3A%0A%20%20%20%20spark%20%3D%20(%0A%20%20%20%20%20%20%20%20SparkSession.builder.appName(%22Airbnb%20Listing%20Overview%22)%0A%20%20%20%20%20%20%20%20.config(%22spark.sql.files.maxPartitionBytes%22%2C%20%221MB%22)%0A%20%20%20%20%20%20%20%20.master(%22local%5B*%5D%22)%0A%20%20%20%20%20%20%20%20.getOrCreate()%0A%20%20%20%20)%0A%20%20%20%20spark.sparkContext._jsc.hadoopConfiguration().set(%0A%20%20%20%20%20%20%20%20%22fs.file.impl.disable.cache%22%2C%20%22true%22%0A%20%20%20%20)%0A%20%20%20%20return%20(spark%2C)%0A%0A%0A%40app.cell%0Adef%20_(spark)%3A%0A%20%20%20%20spark%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20tdf%20%3D%20spark.read.csv(%0A%20%20%20%20%23%20%20%20%20%20%22file%3A%2FUsers%2Fajinkyaarvindp%2FDownloads%2FFire.csv%22%2C%0A%20%20%20%20%23%20%20%20%20%20header%3DTrue%2C%0A%20%20%20%20%23%20%20%20%20%20inferSchema%3DTrue%2C%0A%20%20%20%20%23%20%20%20%20%20quote%3D'%22'%2C%0A%20%20%20%20%23%20%20%20%20%20escape%3D'%22'%2C%0A%20%20%20%20%23%20%20%20%20%20multiLine%3DTrue%2C%0A%20%20%20%20%23%20)%0A%0A%20%20%20%20%23%20tdf.show()%0A%0A%20%20%20%20%23%20tdf.orderBy(%22Battalion%22).write_parquet.parquet(path%3D%22.%2Foutput%22%2C%20mode%3D%22overwrite%22)%0A%0A%20%20%20%20%23%20print(tdf.rdd.getNumPartitions())%0A%0A%20%20%20%20%23%20parquetDf1%20%3D%20spark.read.parquet(%22.%2Foutput%2F%22)%0A%0A%20%20%20%20%23%20print(parquetDf1.rdd.getNumPartitions())%0A%0A%20%20%20%20%23%20parquetDf1.rdd.mapPartitionsWithIndex(%0A%20%20%20%20%23%20%20%20%20%20lambda%20i%2C%20it%3A%20%5B(i%2C%20list(it)%5B%3A1%5D)%5D%0A%20%20%20%20%23%20).collect()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20pyspark.sql.types%20import%20StructType%2C%20StructField%2C%20StringType%0A%0A%20%20%20%20schema%20%3D%20StructType(%5B%0A%20%20%20%20%20%20%20%20StructField('id'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('listing_url'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('scrape_id'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('last_scraped'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('source'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('name'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('description'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('neighborhood_overview'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('picture_url'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('host_id'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_url'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_profile_id'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_profile_url'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_name'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_since'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('hosts_time_as_user_years'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('hosts_time_as_user_months'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('hosts_time_as_host_years'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('hosts_time_as_host_months'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_location'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_about'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_response_time'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_response_rate'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_acceptance_rate'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_is_superhost'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_thumbnail_url'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_picture_url'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_neighbourhood'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_listings_count'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_total_listings_count'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_verifications'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_has_profile_pic'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('host_identity_verified'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('neighbourhood'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('neighbourhood_cleansed'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('neighbourhood_group_cleansed'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('latitude'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('longitude'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('property_type'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('room_type'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('accommodates'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('bathrooms'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('bathrooms_text'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('bedrooms'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('beds'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('amenities'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('price'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('minimum_nights'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('maximum_nights'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('minimum_minimum_nights'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('maximum_minimum_nights'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('minimum_maximum_nights'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('maximum_maximum_nights'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('minimum_nights_avg_ntm'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('maximum_nights_avg_ntm'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('calendar_updated'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('has_availability'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('availability_30'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('availability_60'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('availability_90'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('availability_365'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('calendar_last_scraped'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('number_of_reviews'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('number_of_reviews_ltm'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('number_of_reviews_l30d'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('availability_eoy'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('number_of_reviews_ly'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('estimated_occupancy_l365d'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('estimated_revenue_l365d'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('first_review'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('last_review'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('review_scores_rating'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('review_scores_accuracy'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('review_scores_cleanliness'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('review_scores_checkin'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('review_scores_communication'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('review_scores_location'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('review_scores_value'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('license'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('instant_bookable'%2C%20StringType()%2C%20True)%2C%0A%0A%20%20%20%20%20%20%20%20StructField('calculated_host_listings_count'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('calculated_host_listings_count_entire_homes'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('calculated_host_listings_count_private_rooms'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('calculated_host_listings_count_shared_rooms'%2C%20StringType()%2C%20True)%2C%0A%20%20%20%20%20%20%20%20StructField('reviews_per_month'%2C%20StringType()%2C%20True)%0A%20%20%20%20%5D)%0A%0A%20%20%20%20len(schema.fieldNames())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(col%2C%20input_file_name%2C%20spark%2C%20split)%3A%0A%20%20%20%20df%20%3D%20(%0A%20%20%20%20%20%20%20%20spark.read.csv(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22.%2Fdata%2Flistings%2F%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20header%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20schema%3Dschema%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inferSchema%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20quote%3D'%22'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20escape%3D'%22'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20enforceSchema%3DTrue%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20multiLine%3DTrue%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.withColumn(%22city%22%2C%20split(input_file_name()%2C%20%22%2F%22).getItem(10))%0A%20%20%20%20%20%20%20%20.withColumn(%22city%22%2C%20split(col(%22city%22)%2C%20%22_%22).getItem(0))%0A%20%20%20%20)%0A%0A%20%20%20%20df.show()%0A%20%20%20%20return%20(df%2C)%0A%0A%0A%40app.cell%0Adef%20_(col%2C%20df%2C%20mean)%3A%0A%20%20%20%20from%20pyspark.sql.functions%20import%20regexp_replace%0A%0A%20%20%20%20df%20%5C%0A%20%20%20%20%20%20%20%20.select(%22city%22%2C%20%22price%22%2C%20%22accommodates%22)%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22price%22%2C%20regexp_replace(col(%22price%22)%2C%20%22%5B%24%7C%2C%5D%22%2C%20%22%22).cast(%22double%22))%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22accommodates%22%2C%20col(%22accommodates%22).try_cast(%22integer%22))%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22average%22%2C%20col(%22price%22)%20%2F%20col(%22accommodates%22))%20%5C%0A%20%20%20%20%20%20%20%20.dropna()%20%5C%0A%20%20%20%20%20%20%20%20.groupby(%22city%22)%20%5C%0A%20%20%20%20%20%20%20%20.agg(mean(%22average%22))%20%5C%0A%20%20%20%20%20%20%20%20.explain(True)%0A%20%20%20%20return%20(regexp_replace%2C)%0A%0A%0A%40app.cell%0Adef%20_(col%2C%20df%2C%20regexp_replace)%3A%0A%20%20%20%20from%20pyspark.sql.functions%20import%20percent_rank%2C%20expr%0A%20%20%20%20from%20pyspark.sql.window%20import%20Window%0A%0A%20%20%20%20windowSpec%20%3D%20Window.partitionBy(%22city%22).orderBy(%22average%22)%0A%0A%20%20%20%20df%20%5C%0A%20%20%20%20%20%20%20%20.select(%22city%22%2C%20%22price%22%2C%20%22accommodates%22)%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22price%22%2C%20regexp_replace(col(%22price%22)%2C%20%22%5B%24%7C%2C%5D%22%2C%20%22%22).cast(%22double%22))%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22accommodates%22%2C%20col(%22accommodates%22).try_cast(%22integer%22))%20%5C%0A%20%20%20%20%20%20%20%20.withColumn(%22average%22%2C%20col(%22price%22)%20%2F%20col(%22accommodates%22))%20%5C%0A%20%20%20%20%20%20%20%20.dropna()%20%5C%0A%20%20%20%20%20%20%20%20.groupby(%22city%22)%20%5C%0A%20%20%20%20%20%20%20%20.agg(%0A%20%20%20%20%20%20%20%20%20%20%20%20expr(%22percentile_approx(average%2C%200.25)%22).alias(%22p25%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20expr(%22percentile_approx(average%2C%200.90)%22).alias(%22p90%22)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(a)%3A%0A%20%20%20%20a.plot.bar(x%3D'PercentRank'%2C%20y%3D'PercentRank')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20df%20%5C%0A%20%20%20%20%20%20%20%20.select(%22city%22%2C%20%22bedrooms%22%2C%20%22price%22)%20%5C%0A%20%20%20%20%20%20%20%20.dropna()%20%5C%0A%20%20%20%20%20%20%20%20.count()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20spark.stop()%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">41086f07c82b3060a8978df3ec76d907</marimo-code-hash>
</body>
</html>
