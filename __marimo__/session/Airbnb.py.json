{
  "version": "1",
  "metadata": {
    "marimo_version": "0.19.0"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "eb4540014c3beabbf232165ec5d3d75f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "68bb2dfb81f6dd6dcc7ec418dc07e894",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "WARNING: Using incubator modules: jdk.incubator.vector\nUsing Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties\n26/01/13 15:39:37 WARN Utils: Your hostname, Ajinkyas-MacBook-Pro.local, resolves to a loopback address: 127.0.0.1; using 192.168.1.52 instead (on interface en0)\n26/01/13 15:39:37 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address\nUsing Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n26/01/13 15:39:38 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "98f11b7a7880169c3bd62a5a507b3965",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "\n            <div>\n                <p><b>SparkSession - in-memory</b></p>\n                \n        <div>\n            <p><b>SparkContext</b></p>\n\n            <p><a href=\"http://192.168.1.52:4040\">Spark UI</a></p>\n\n            <dl>\n              <dt>Version</dt>\n                <dd><code>v4.1.0</code></dd>\n              <dt>Master</dt>\n                <dd><code>local[*]</code></dd>\n              <dt>AppName</dt>\n                <dd><code>Airbnb Listing Overview</code></dd>\n            </dl>\n        </div>\n        \n            </div>\n        "
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "77d70383dba6a834bc7d33364597cd53",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "ddde1f80d2855976657bbb7c2c31a951",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre class='text-xs'>85</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "a661dd9c093ae481be0cd2b756f28537",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 1:>                                                          (0 + 9) / 9]\r\r[Stage 1:======>                                                    (1 + 8) / 9]\r\r[Stage 1:=============>                                             (2 + 7) / 9]\r\r[Stage 1:==========================>                                (4 + 5) / 9]\r\r[Stage 1:====================================================>      (8 + 1) / 9]\r\r                                                                                \r26/01/13 15:39:47 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.\n",
          "mimetype": "text/plain"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "+------+--------------------+--------------+------------+---------------+--------------------+--------------------+---------------------+--------------------+-------+--------------------+--------------+----------+--------------------+--------------------+------------------+------------------+--------------------+-----------------+--------------------+--------------------+--------------------+-------------------+-------------------------+--------------------+--------------------+----------------------+--------------------+----------------------+----------------------------+------------------+--------------------+--------------------+---------------+------------+---------+----------------+--------+----+--------------------+-------+--------------+--------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------+----------------+---------------+---------------+---------------+----------------+---------------------+-----------------+---------------------+----------------------+----------------+--------------------+-------------------------+-----------------------+------------+-----------+--------------------+----------------------+-------------------------+---------------------+---------------------------+----------------------+-------------------+-------+----------------+------------------------------+-------------------------------------------+--------------------------------------------+-------------------------------------------+-----------------+----------+\n|    id|         listing_url|     scrape_id|last_scraped|         source|                name|         description|neighborhood_overview|         picture_url|host_id|            host_url|     host_name|host_since|       host_location|          host_about|host_response_time|host_response_rate|host_acceptance_rate|host_is_superhost|  host_thumbnail_url|    host_picture_url|  host_neighbourhood|host_listings_count|host_total_listings_count|  host_verifications|host_has_profile_pic|host_identity_verified|       neighbourhood|neighbourhood_cleansed|neighbourhood_group_cleansed|          latitude|           longitude|       property_type|      room_type|accommodates|bathrooms|  bathrooms_text|bedrooms|beds|           amenities|  price|minimum_nights|maximum_nights|minimum_minimum_nights|maximum_minimum_nights|minimum_maximum_nights|maximum_maximum_nights|minimum_nights_avg_ntm|maximum_nights_avg_ntm|calendar_updated|has_availability|availability_30|availability_60|availability_90|availability_365|calendar_last_scraped|number_of_reviews|number_of_reviews_ltm|number_of_reviews_l30d|availability_eoy|number_of_reviews_ly|estimated_occupancy_l365d|estimated_revenue_l365d|first_review|last_review|review_scores_rating|review_scores_accuracy|review_scores_cleanliness|review_scores_checkin|review_scores_communication|review_scores_location|review_scores_value|license|instant_bookable|calculated_host_listings_count|calculated_host_listings_count_entire_homes|calculated_host_listings_count_private_rooms|calculated_host_listings_count_shared_rooms|reviews_per_month|      city|\n+------+--------------------+--------------+------------+---------------+--------------------+--------------------+---------------------+--------------------+-------+--------------------+--------------+----------+--------------------+--------------------+------------------+------------------+--------------------+-----------------+--------------------+--------------------+--------------------+-------------------+-------------------------+--------------------+--------------------+----------------------+--------------------+----------------------+----------------------------+------------------+--------------------+--------------------+---------------+------------+---------+----------------+--------+----+--------------------+-------+--------------+--------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------+----------------+---------------+---------------+---------------+----------------+---------------------+-----------------+---------------------+----------------------+----------------+--------------------+-------------------------+-----------------------+------------+-----------+--------------------+----------------------+-------------------------+---------------------+---------------------------+----------------------+-------------------+-------+----------------+------------------------------+-------------------------------------------+--------------------------------------------+-------------------------------------------+-----------------+----------+\n|264776|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Huge Four Bedroom...|An extremely larg...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44306|            -0.01948|  Entire rental unit|Entire home/apt|          10|      2.0|         2 baths|     4.0|   8|[\"Cooking basics\"...|$297.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|             13|             15|           31.0|           293.0|           2025-06-11|               68|                   12|                     1|             134|                  15|                      110|                32670.0|  2014-07-03| 2025-05-28|                4.68|                  4.65|                     4.72|                 4.84|                       4.74|                  4.62|               4.72|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.51|2025-06-10|\n|264777|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|One Bedroom Apart...|Recently refurbis...|                 NULL|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|                NULL|              Lewisham|                        NULL|          51.44284|            -0.01997|  Entire rental unit|Entire home/apt|           2|      1.0|          1 bath|     1.0|   2|[\"Cooking basics\"...| $98.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              0|             13|           43.0|           318.0|           2025-06-11|               24|                    4|                     0|             157|                   7|                       37|                 3626.0|  2016-07-21| 2024-12-11|                4.58|                  4.42|                     4.54|                 4.58|                       4.25|                  4.54|               4.42|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.22|2025-06-10|\n|264778|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Two Bedroom Newly...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44359|            -0.02275|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     2.0|   3|[\"Cooking basics\"...|$148.00|           3.0|           365|                     1|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              3|              6|           27.0|           302.0|           2025-06-11|               58|                    6|                     0|             141|                   8|                       55|                 8140.0|  2014-04-21| 2025-05-01|                 4.5|                   4.5|                     4.45|                 4.72|                       4.52|                  4.36|               4.38|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.43|2025-06-10|\n|264779|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Refurbished Two B...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44355|            -0.02309|  Entire rental unit|Entire home/apt|           5|      1.0|          1 bath|     2.0|   5|[\"Cooking basics\"...|$144.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|             11|             33|           53.0|           328.0|           2025-06-11|               36|                    7|                     0|             167|                   7|                       64|                 9216.0|  2015-07-23| 2025-04-10|                4.64|                  4.67|                     4.58|                 4.83|                       4.61|                   4.5|               4.47|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.30|2025-06-10|\n|264780|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Spacious refurbis...|Completely refurb...|                 NULL|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|                NULL|              Lewisham|                        NULL|          51.44333|            -0.02307|  Entire rental unit|Entire home/apt|           4|      2.0|         2 baths|     2.0|   4|[\"Cooking basics\"...|$157.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              0|              9|           11.0|           255.0|           2025-06-11|               54|                    4|                     0|             101|                   7|                       37|                 5809.0|  2012-09-18| 2024-12-29|                4.68|                  4.78|                     4.65|                 4.81|                       4.74|                  4.37|               4.59|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.35|2025-06-10|\n|264781|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Two Bedrooms Gard...|A two bedroom, 2 ...| Catford is an up ...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44204|            -0.02149|  Entire rental unit|Entire home/apt|           3|      2.0|         2 baths|     2.0|   2|[\"Cooking basics\"...|$148.00|           3.0|           365|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              2|              2|           27.0|           274.0|           2025-06-11|                8|                    0|                     0|             113|                   0|                        0|                    0.0|  2017-10-23| 2023-08-12|                3.88|                  4.13|                     3.75|                 4.88|                       4.63|                   4.5|               4.13|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.09|2025-06-10|\n|264782|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|One Bedroom Garde...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44353|            -0.02328|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     1.0|   3|[\"Cooking basics\"...|$120.00|           4.0|           365|                     4|                     4|                  1125|                  1125|                   4.0|                1125.0|            NULL|               t|              6|             23|           48.0|           323.0|           2025-06-11|               17|                    4|                     1|             162|                   4|                       37|                 4440.0|  2018-06-30| 2025-05-20|                4.59|                  4.53|                     4.47|                 4.76|                       4.71|                  4.53|               4.65|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.20|2025-06-10|\n|264783|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Four Bedroom Gard...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44151|            -0.02195|  Entire rental unit|Entire home/apt|           7|      2.0|         2 baths|     4.0|   6|[\"Cooking basics\"...|$216.00|           4.0|           365|                     4|                     4|                  1125|                  1125|                   4.0|                1125.0|            NULL|               t|              6|             17|           29.0|           295.0|           2025-06-11|               44|                    4|                     0|             134|                   4|                       37|                 7992.0|  2013-10-07| 2025-05-04|                4.64|                   4.5|                     4.43|                 4.75|                       4.77|                  4.52|               4.48|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.31|2025-06-10|\n|264789|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Huge Three Bedroo...|A large and sunny...| Catford is a well...|https://a0.muscac...|1389063|https://www.airbn...|           Sue|2011-11-09|      United Kingdom|I own the Glenthu...|    within an hour|               86%|                100%|                f|https://a0.muscac...|https://a0.muscac...|          Bellingham|                 11|                       12|  ['email', 'phone']|                   t|                     t|Neighborhood high...|              Lewisham|                        NULL|          51.44346|            -0.02122|  Entire rental unit|Entire home/apt|           7|      2.0|         2 baths|     3.0|   4|[\"Cooking basics\"...|$238.00|           3.0|           365|                     4|                     4|                  1125|                  1125|                   4.0|                1125.0|            NULL|               t|             17|             27|           47.0|           322.0|           2025-06-11|               65|                   12|                     0|             161|                  16|                      110|                26180.0|  2015-02-15| 2025-04-19|                4.72|                  4.68|                     4.54|                 4.97|                       4.88|                  4.49|               4.68|   NULL|               t|                          11.0|                                       11.0|                                         0.0|                                        0.0|             0.52|2025-06-10|\n|266037|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Central London wi...|We've welcomed ov...| Our local area ha...|https://a0.muscac...|1395281|https://www.airbn...|         James|2011-11-11|England, United K...|I'm a culture vul...|within a few hours|              100%|                100%|                t|https://a0.muscac...|https://a0.muscac...|         St. Pancras|                  1|                        3|  ['email', 'phone']|                   t|                     t|Neighborhood high...|                Camden|                        NULL|          51.52617|             -0.1302|Private room in r...|   Private room|           1|      1.5|1.5 shared baths|     1.0|   1|[\"Washer\", \"Iron\"...| $62.00|           7.0|            90|                     7|                     7|                    90|                    90|                   7.0|                  90.0|            NULL|               t|              1|              2|            2.0|            27.0|           2025-06-12|              532|                   18|                     1|              27|                  17|                      252|                15624.0|  2011-11-20| 2025-05-15|                 4.9|                  4.88|                     4.86|                 4.92|                       4.92|                  4.94|               4.84|   NULL|               f|                           1.0|                                        0.0|                                         1.0|                                        0.0|             3.22|2025-06-10|\n|268398|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Also five minutes...|This is a clean a...| This is central L...|https://a0.muscac...| 979363|https://www.airbn...|       Donovan|2011-08-16|London, United Ki...|I am Donovan and ...|    within an hour|              100%|                100%|                t|https://a0.muscac...|https://a0.muscac...|          South Bank|                  6|                        7|  ['email', 'phone']|                   t|                     t|Neighborhood high...|               Lambeth|                        NULL|          51.50287|            -0.10937|Private room in r...|   Private room|           2|      1.5|1.5 shared baths|     1.0|   2|[\"Cooking basics\"...| $66.00|           1.0|          1125|                     1|                     1|                  1125|                  1125|                   1.0|                1125.0|            NULL|               t|              2|              6|           14.0|           104.0|           2025-06-12|              563|                    4|                     1|              86|                  15|                       37|                 2442.0|  2011-12-09| 2025-05-15|                4.63|                  4.72|                     4.76|                 4.68|                       4.75|                  4.82|               4.56|   NULL|               t|                           6.0|                                        1.0|                                         5.0|                                        0.0|             3.42|2025-06-10|\n|270600|https://www.airbn...|20250610032232|  2025-06-11|    city scrape|Patio Apartment i...|This immaculate p...|                 NULL|https://a0.muscac...|1416605|https://www.airbn...|          Emma|2011-11-17|London, United Ki...|Hi there,\\r\\n\\r\\n...|    within an hour|              100%|                100%|                t|https://a0.muscac...|https://a0.muscac...|                NULL|                  3|                        3|  ['email', 'phone']|                   t|                     t|                NULL|  Richmond upon Thames|                        NULL|          51.44311|            -0.33245|  Entire rental unit|Entire home/apt|           3|      1.0|          1 bath|     1.0|   1|[\"Cooking basics\"...| $73.00|           4.0|          9011|                     4|                     4|                  9011|                  9011|                   4.0|                9011.0|            NULL|               t|              0|              0|            0.0|           204.0|           2025-06-11|               88|                    7|                     0|              43|                   9|                       64|                 4672.0|  2013-07-17| 2025-04-15|                4.64|                  4.68|                     4.76|                 4.94|                       4.94|                  4.92|               4.58|   NULL|               t|                           3.0|                                        2.0|                                         1.0|                                        0.0|             0.61|2025-06-10|\n|271122|https://www.airbn...|20250610032232|  2025-06-13|previous scrape|Heathrow BNB - Ho...|This room is by f...|                 NULL|https://a0.muscac...|1419096|https://www.airbn...|       Claudia|2011-11-18|Michigan, United ...|I'm from a black ...|               N/A|               N/A|                 N/A|                f|https://a0.muscac...|https://a0.muscac...|    LB of Hillingdon|                  4|                        4|  ['email', 'phone']|                   t|                     f|                NULL|            Hillingdon|                        NULL|          51.53097|            -0.39891|Private room in home|   Private room|           2|     NULL|          1 bath|    NULL|NULL|[\"Lock on bedroom...|   NULL|           1.0|           365|                     1|                     1|                   365|                   365|                   1.0|                 365.0|            NULL|               t|              0|              0|            0.0|             0.0|           2025-06-13|                7|                    0|                     0|               0|                   0|                        0|                   NULL|  2013-06-28| 2017-05-27|                4.14|                  3.86|                     4.57|                 4.71|                       4.29|                  4.14|                4.0|   NULL|               t|                           4.0|                                        1.0|                                         3.0|                                        0.0|             0.05|2025-06-10|\n|425143|https://www.airbn...|20250610032232|  2025-06-13|previous scrape|luxury 1bed in Ch...|                NULL|                 NULL|https://a0.muscac...|2011372|https://www.airbn...|        Cagdas|2012-03-26|London, United Ki...|Hi everyone,\\r\\nI...|               N/A|               N/A|                 N/A|                f|https://a0.muscac...|https://a0.muscac...|           Nine Elms|                  1|                        1|  ['email', 'phone']|                   t|                     t|                NULL|            Wandsworth|                        NULL|          51.48295|             -0.1476|  Entire rental unit|Entire home/apt|           3|     NULL|          1 bath|     1.0|NULL|[\"Washer\", \"Iron\"...|   NULL|           3.0|          1125|                     3|                     3|                  1125|                  1125|                   3.0|                1125.0|            NULL|               t|              0|              0|            0.0|             0.0|           2025-06-13|               34|                    0|                     0|               0|                   0|                        0|                   NULL|  2012-07-03| 2017-03-01|                4.88|                  4.88|                     4.67|                 4.88|                       4.94|                  4.78|               4.73|   NULL|               f|                           1.0|                                        1.0|                                         0.0|                                        0.0|             0.22|2025-06-10|\n|426351|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|2 Bed Edwardian M...|Great space to se...| I live in a frien...|https://a0.muscac...|2119157|https://www.airbn...|       Majella|2012-04-11|London, United Ki...|I like to experie...|    within an hour|              100%|                100%|                f|https://a0.muscac...|https://a0.muscac...|         LB of Brent|                  2|                        4|['email', 'phone'...|                   t|                     f|Neighborhood high...|                 Brent|                        NULL|          51.55814|            -0.22465|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     2.0|   2|[\"Cooking basics\"...|$134.00|           3.0|            21|                     3|                     3|                    21|                    21|                   3.0|                  21.0|            NULL|               t|              9|             22|           48.0|           323.0|           2025-06-12|                7|                    0|                     0|             161|                   0|                        0|                    0.0|  2013-11-19| 2023-07-25|                4.71|                  4.71|                     4.43|                 4.86|                       4.86|                  4.43|               4.43|   NULL|               f|                           2.0|                                        1.0|                                         1.0|                                        0.0|             0.05|2025-06-10|\n|426354|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|1 bedroom flat wi...|My one bedroom fl...| Portobello Road a...|https://a0.muscac...|2119740|https://www.airbn...|         Andr\u00e9|2012-04-11|London, United Ki...|I'm from Sweden b...|within a few hours|              100%|                100%|                f|https://a0.muscac...|https://a0.muscac...|RB of Kensington ...|                  1|                        1|  ['email', 'phone']|                   t|                     t|Neighborhood high...|  Kensington and Ch...|                        NULL|          51.52538|            -0.21057|  Entire rental unit|Entire home/apt|           2|      1.0|          1 bath|     1.0|   4|[\"Cooking basics\"...|$200.00|           5.0|             9|                     5|                     5|                     9|                     9|                   5.0|                   9.0|            NULL|               t|              0|              0|            9.0|            44.0|           2025-06-12|               13|                    2|                     0|              40|                   2|                       20|                 4000.0|  2012-04-19| 2024-12-16|                4.92|                   5.0|                      5.0|                  5.0|                        5.0|                  4.73|                5.0|   NULL|               f|                           1.0|                                        1.0|                                         0.0|                                        0.0|             0.08|2025-06-10|\n|427229|https://www.airbn...|20250610032232|  2025-06-13|previous scrape|    Kitchener House!|                NULL|                 NULL|https://a0.muscac...|2087745|https://www.airbn...|          Tony|2012-04-07|London, United Ki...|I am a London tea...|               N/A|               N/A|                 N/A|                f|https://a0.muscac...|https://a0.muscac...|     RB of Greenwich|                  2|                        2|  ['email', 'phone']|                   t|                     f|                NULL|             Greenwich|                        NULL|          51.47574|             0.05733|Private room in r...|   Private room|           1|     NULL|            NULL|     1.0|NULL|                  []|   NULL|           1.0|          1125|                     1|                     1|                  1125|                  1125|                   1.0|                1125.0|            NULL|            NULL|              0|              0|            0.0|             0.0|           2025-06-13|                0|                    0|                     0|               0|                   0|                        0|                   NULL|        NULL|       NULL|                NULL|                  NULL|                     NULL|                 NULL|                       NULL|                  NULL|               NULL|   NULL|               f|                           2.0|                                        1.0|                                         1.0|                                        0.0|             NULL|2025-06-10|\n|427327|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Cool shoreditch c...|                NULL|                 NULL|https://a0.muscac...|2124088|https://www.airbn...|       Corrine|2012-04-12|London, United Ki...|Art Director & Pr...|      within a day|              100%|                 71%|                f|https://a0.muscac...|https://a0.muscac...|          Shoreditch|                  3|                        7|['email', 'phone'...|                   t|                     t|                NULL|               Hackney|                        NULL|          51.52412|            -0.07869|  Entire rental unit|Entire home/apt|           4|      1.0|          1 bath|     1.0|   1|[\"TV\", \"Essentials\"]|$155.00|           3.0|            64|                     3|                     3|                    64|                    64|                   3.0|                  64.0|            NULL|               t|              0|              3|           33.0|           308.0|           2025-06-12|                0|                    0|                     0|             146|                   0|                        0|                    0.0|        NULL|       NULL|                NULL|                  NULL|                     NULL|                 NULL|                       NULL|                  NULL|               NULL|   NULL|               f|                           1.0|                                        1.0|                                         0.0|                                        0.0|             NULL|2025-06-10|\n|427348|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Lovely 2 bedroom ...|Modern, luminous ...| Brixton is a live...|https://a0.muscac...|2124185|https://www.airbn...|Graham & Ivano|2012-04-12|London, United Ki...|We are a couple b...|      within a day|              100%|                 33%|                f|https://a0.muscac...|https://a0.muscac...|          Herne Hill|                  2|                        3|  ['email', 'phone']|                   t|                     t|Neighborhood high...|               Lambeth|                        NULL|          51.46837|            -0.09851|        Entire condo|Entire home/apt|           5|      2.0|         2 baths|     2.0|   2|[\"Cooking basics\"...|$135.00|           7.0|            12|                     9|                     9|                    12|                    12|                   9.0|                  12.0|            NULL|               t|              8|             32|           62.0|           152.0|           2025-06-12|               23|                    0|                     0|             152|                   0|                        0|                    0.0|  2013-01-03| 2023-01-03|                4.77|                  4.78|                     4.39|                 4.78|                       4.78|                  4.48|               4.65|   NULL|               f|                           2.0|                                        1.0|                                         1.0|                                        0.0|             0.15|2025-06-10|\n|427584|https://www.airbn...|20250610032232|  2025-06-12|    city scrape|Hackney Stylish &...|Very bright and s...| An abundance of c...|https://a0.muscac...|2125123|https://www.airbn...|        Sophie|2012-04-12|London, United Ki...|Hi my name is Sop...|    within an hour|              100%|                 91%|                t|https://a0.muscac...|https://a0.muscac...|             Dalston|                 10|                       35|  ['email', 'phone']|                   t|                     t|Neighborhood high...|               Hackney|                        NULL|51.547550201416016|-0.06635300070047379|        Entire condo|Entire home/apt|           3|      1.0|          1 bath|     1.0|   1|[\"Cooking basics\"...|$129.00|           5.0|           300|                     2|                     6|                   300|                   300|                   5.2|                 300.0|            NULL|               t|              2|              5|           17.0|           100.0|           2025-06-12|              152|                    6|                     0|             100|                  10|                       60|                 7740.0|  2012-06-20| 2024-09-24|                4.65|                   4.7|                     4.64|                 4.84|                       4.91|                  4.75|               4.61|   NULL|               t|                           5.0|                                        5.0|                                         0.0|                                        0.0|             0.96|2025-06-10|\n+------+--------------------+--------------+------------+---------------+--------------------+--------------------+---------------------+--------------------+-------+--------------------+--------------+----------+--------------------+--------------------+------------------+------------------+--------------------+-----------------+--------------------+--------------------+--------------------+-------------------+-------------------------+--------------------+--------------------+----------------------+--------------------+----------------------+----------------------------+------------------+--------------------+--------------------+---------------+------------+---------+----------------+--------+----+--------------------+-------+--------------+--------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------+----------------+---------------+---------------+---------------+----------------+---------------------+-----------------+---------------------+----------------------+----------------+--------------------+-------------------------+-----------------------+------------+-----------+--------------------+----------------------+-------------------------+---------------------+---------------------------+----------------------+-------------------+-------+----------------+------------------------------+-------------------------------------------+--------------------------------------------+-------------------------------------------+-----------------+----------+\nonly showing top 20 rows\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "SFPL",
      "code_hash": "6385fb302eb4199e7d55cf9bfe61c5f4",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "== Parsed Logical Plan ==\n'Aggregate ['city], ['city, unresolvedalias('avg('average))]\n+- Filter atleastnnonnulls(4, city#81, price#402, accommodates#403, average#404)\n   +- Project [city#81, price#402, accommodates#403, (price#402 / cast(accommodates#403 as double)) AS average#404]\n      +- Project [city#81, price#402, try_cast(accommodates#34 as int) AS accommodates#403]\n         +- Project [city#81, cast(regexp_replace(price#40, [$|,], , 1) as double) AS price#402, accommodates#34]\n            +- Project [city#81, price#40, accommodates#34]\n               +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                  +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                     +- Relation [id#0L,listing_url#1,scrape_id#2L,last_scraped#3,source#4,name#5,description#6,neighborhood_overview#7,picture_url#8,host_id#9,host_url#10,host_name#11,host_since#12,host_location#13,host_about#14,host_response_time#15,host_response_rate#16,host_acceptance_rate#17,host_is_superhost#18,host_thumbnail_url#19,host_picture_url#20,host_neighbourhood#21,host_listings_count#22,host_total_listings_count#23,host_verifications#24,... 54 more fields] csv\n\n== Analyzed Logical Plan ==\ncity: string, avg(average): double\nAggregate [city#81], [city#81, avg(average#404) AS avg(average)#410]\n+- Filter atleastnnonnulls(4, city#81, price#402, accommodates#403, average#404)\n   +- Project [city#81, price#402, accommodates#403, (price#402 / cast(accommodates#403 as double)) AS average#404]\n      +- Project [city#81, price#402, try_cast(accommodates#34 as int) AS accommodates#403]\n         +- Project [city#81, cast(regexp_replace(price#40, [$|,], , 1) as double) AS price#402, accommodates#34]\n            +- Project [city#81, price#40, accommodates#34]\n               +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                  +- Project [id#0L, listing_url#1, scrape_id#2L, last_scraped#3, source#4, name#5, description#6, neighborhood_overview#7, picture_url#8, host_id#9, host_url#10, host_name#11, host_since#12, host_location#13, host_about#14, host_response_time#15, host_response_rate#16, host_acceptance_rate#17, host_is_superhost#18, host_thumbnail_url#19, host_picture_url#20, host_neighbourhood#21, host_listings_count#22, host_total_listings_count#23, host_verifications#24, ... 55 more fields]\n                     +- Relation [id#0L,listing_url#1,scrape_id#2L,last_scraped#3,source#4,name#5,description#6,neighborhood_overview#7,picture_url#8,host_id#9,host_url#10,host_name#11,host_since#12,host_location#13,host_about#14,host_response_time#15,host_response_rate#16,host_acceptance_rate#17,host_is_superhost#18,host_thumbnail_url#19,host_picture_url#20,host_neighbourhood#21,host_listings_count#22,host_total_listings_count#23,host_verifications#24,... 54 more fields] csv\n\n== Optimized Logical Plan ==\nAggregate [city#81], [city#81, avg(average#404) AS avg(average)#410]\n+- Project [split(city#80, _, -1)[0] AS city#81, (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)) AS average#404]\n   +- Filter atleastnnonnulls(4, split(city#80, _, -1)[0], cast(regexp_replace(price#40, [$|,], , 1) as double), try_cast(accommodates#34 as int), (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)))\n      +- Project [accommodates#34, price#40, split(input_file_name(), /, -1)[10] AS city#80]\n         +- Relation [id#0L,listing_url#1,scrape_id#2L,last_scraped#3,source#4,name#5,description#6,neighborhood_overview#7,picture_url#8,host_id#9,host_url#10,host_name#11,host_since#12,host_location#13,host_about#14,host_response_time#15,host_response_rate#16,host_acceptance_rate#17,host_is_superhost#18,host_thumbnail_url#19,host_picture_url#20,host_neighbourhood#21,host_listings_count#22,host_total_listings_count#23,host_verifications#24,... 54 more fields] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- HashAggregate(keys=[city#81], functions=[avg(average#404)], output=[city#81, avg(average)#410])\n   +- Exchange hashpartitioning(city#81, 200), ENSURE_REQUIREMENTS, [plan_id=38]\n      +- HashAggregate(keys=[city#81], functions=[partial_avg(average#404)], output=[city#81, sum#413, count#414L])\n         +- Project [split(city#80, _, -1)[0] AS city#81, (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)) AS average#404]\n            +- Filter atleastnnonnulls(4, split(city#80, _, -1)[0], cast(regexp_replace(price#40, [$|,], , 1) as double), try_cast(accommodates#34 as int), (cast(regexp_replace(price#40, [$|,], , 1) as double) / cast(try_cast(accommodates#34 as int) as double)))\n               +- Project [accommodates#34, price#40, split(input_file_name(), /, -1)[10] AS city#80]\n                  +- FileScan csv [accommodates#34,price#40] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/Users/ajinkyaarvindp/Home/Work/spark/data/listings], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<accommodates:string,price:string>\n\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "BYtC",
      "code_hash": "b372846f4520d2a751b95094e6000f6c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='BYtC-0' random-id='9f241db7-8aa2-ac96-95fd-a1fc0471a46d'><marimo-table data-initial-value='[]' data-label='null' data-data='[]' data-total-rows='&quot;too_many&quot;' data-total-columns='0' data-max-columns='50' data-banner-text='&quot;Previewing only the first 10 rows.&quot;' data-pagination='false' data-page-size='10' data-show-filters='true' data-show-download='false' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='true' data-preload='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "2bd7126d3e0b8ac5f2734b3019843c00",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "name 'a' is not defined",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/var/folders/vt/wzvpy6nx2575z7q8v90zrhhr0000gn/T/marimo_9031/__marimo__cell_RGSE_.py&quot;</span>, line <span class=\"m\">1</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"o\">=</span><span class=\"s1\">&#39;PercentRank&#39;</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"o\">=</span><span class=\"s1\">&#39;PercentRank&#39;</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"pm\">^</span>\n<span class=\"gr\">NameError</span>: <span class=\"n\">name &#39;a&#39; is not defined</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "Kclp",
      "code_hash": "e5c25a916d1eb1fedffbf54a1f67d614",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre class='text-xs'>1366276</pre>"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "26/01/13 15:39:47 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-12-04_los-angeles_listings.csv.gz\n\r[Stage 3:>                                                        (0 + 11) / 67]\r\r[Stage 3:>                                                        (1 + 11) / 67]\r26/01/13 15:39:49 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-01-03_new-york-city_listings.csv.gz\n\r[Stage 3:===>                                                     (4 + 11) / 67]\r26/01/13 15:39:49 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-12-04_new-york-city_listings.csv.gz\n\r[Stage 3:====>                                                    (5 + 11) / 67]\r\r[Stage 3:=======>                                                 (9 + 11) / 67]\r\r[Stage 3:=============>                                          (16 + 11) / 67]\r\r[Stage 3:===============>                                        (18 + 11) / 67]\r26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2024-12-27_mexico-city_listings.csv.gz\n26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2024-12-25_bangkok_listings.csv.gz\n26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2024-12-30_tokyo_listings.csv.gz\n26/01/13 15:39:50 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 75, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-01-09_toronto_listings.csv.gz\n\r[Stage 3:======================>                                 (27 + 11) / 67]\r\r[Stage 3:==============================>                         (37 + 11) / 67]\r\r[Stage 3:===============================>                        (38 + 11) / 67]\r\r[Stage 3:======================================>                 (46 + 12) / 67]\r\r[Stage 3:========================================>               (49 + 11) / 67]\r26/01/13 15:39:51 WARN CSVHeaderChecker: Number of column in CSV header is not equal to number of fields in the schema:\n Header length: 85, schema size: 79\nCSV file: file:///Users/ajinkyaarvindp/Home/Work/spark/data/listings/2025-12-04_san-francisco_listings.csv.gz\n\r                                                                                \r",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "emfo",
      "code_hash": "8f40f19654236b4fcb0f63c4efd5efd2",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    }
  ]
}